<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurante Sabor - Card√°pio Digital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .category-scroll {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .category-scroll::-webkit-scrollbar {
            display: none;
        }
        
        .fade-in {
            animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-up {
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .premium-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .premium-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px -8px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #ea580c 0%, #dc2626 100%);
            transform: translateY(-1px);
            box-shadow: 0 8px 16px -4px rgba(249, 115, 22, 0.3);
        }

        .option-item {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #e5e7eb;
        }

        .option-item:hover {
            border-color: #d1d5db;
            background: #fafafa;
        }

        .option-item.selected {
            border-color: #3b82f6;
            background: #eff6ff;
            box-shadow: 0 0 0 1px #3b82f6;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 2px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .quantity-btn {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .quantity-btn:hover {
            transform: scale(1.05);
        }

        .status-indicator {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">
    <!-- Hero Section -->
    <div class="relative h-44 sm:h-56 bg-gradient-to-br from-slate-800 via-slate-700 to-slate-900 overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"></div>
        <div class="absolute inset-0 flex items-center justify-center">
            <div class="text-center text-white px-4">
                <div class="text-4xl sm:text-5xl mb-3">üçΩÔ∏è</div>
                <h1 class="text-xl sm:text-2xl font-semibold mb-1 tracking-tight">Restaurante Sabor</h1>
                <p class="text-xs sm:text-sm text-slate-200 font-light">Sabores √∫nicos, experi√™ncias inesquec√≠veis</p>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <div class="bg-gradient-to-r from-emerald-50 to-green-50 border-b border-emerald-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-center py-2.5">
                <div class="flex items-center space-x-2">
                    <div class="w-1.5 h-1.5 bg-emerald-500 rounded-full status-indicator"></div>
                    <span class="text-xs text-emerald-700 font-medium">Aberto agora - Pedidos at√© 23h</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Header - Mobile Only -->
    <header class="lg:hidden bg-white/95 backdrop-blur-sm shadow-sm sticky top-0 z-40 border-b border-slate-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-14">
                <button class="flex items-center space-x-3 hover:bg-slate-50 rounded-lg p-2 -m-2 transition-colors" onclick="app.openRestaurantModal()">
                    <div class="w-8 h-8 bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg flex items-center justify-center shadow-sm">
                        <i class="fas fa-utensils text-white text-xs"></i>
                    </div>
                    <div class="text-left">
                        <h1 class="text-base font-semibold text-slate-900">Restaurante Sabor</h1>
                        <p class="text-xs text-slate-500">Delivery ‚Ä¢ Local ‚Ä¢ Retirada</p>
                    </div>
                    <div class="text-slate-400 ml-2">
                        <i class="fas fa-chevron-right text-xs"></i>
                    </div>
                </button>
                
                <div class="flex items-center">
                    <button class="relative btn-primary text-white px-3 py-2 rounded-lg text-sm font-medium shadow-sm" id="cart-btn-mobile">
                        <i class="fas fa-shopping-cart mr-1.5 text-xs"></i>
                        Carrinho
                        <span id="cart-count-mobile" class="absolute -top-1.5 -right-1.5 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center hidden font-semibold">0</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Search Bar -->
    <div class="lg:hidden bg-white border-b border-slate-100 px-4 py-3 sticky top-14 z-30">
        <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-search text-slate-400 text-sm"></i>
            </div>
            <input 
                type="text" 
                id="search-input-mobile"
                placeholder="Buscar produto..." 
                class="w-full pl-9 pr-4 py-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 transition-all text-sm bg-slate-50/50"
            >
        </div>
    </div>

    <!-- Mobile Categories -->
    <div class="lg:hidden bg-white border-b border-slate-100 sticky top-[6.75rem] z-30">
        <div class="px-4 py-3">
            <div class="flex space-x-2 overflow-x-auto category-scroll pb-1" id="mobile-categories">
                <!-- Categories will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Desktop Layout with Sidebar -->
    <div class="hidden lg:flex min-h-screen">
        <!-- Desktop Sidebar -->
        <aside class="w-72 bg-white border-r border-slate-200 flex-shrink-0">
            <div class="sticky top-0 h-screen overflow-y-auto custom-scrollbar">
                <div class="p-6 space-y-6">
                    <!-- Restaurant Profile -->
                    <button class="w-full flex items-center space-x-3 p-4 rounded-xl bg-slate-50 border border-slate-100 hover:bg-slate-100 hover:border-slate-200 transition-all cursor-pointer" onclick="app.openRestaurantModal()">
                        <div class="w-10 h-10 bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl flex items-center justify-center flex-shrink-0 shadow-sm">
                            <i class="fas fa-utensils text-white text-sm"></i>
                        </div>
                        <div class="flex-1 min-w-0 text-left">
                            <h1 class="text-base font-semibold text-slate-900 truncate">Restaurante Sabor</h1>
                            <p class="text-xs text-slate-500">Delivery ‚Ä¢ Local ‚Ä¢ Retirada</p>
                        </div>
                        <div class="text-slate-400">
                            <i class="fas fa-chevron-right text-xs"></i>
                        </div>
                    </button>
                    
                    <!-- Search Bar -->
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                            <i class="fas fa-search text-slate-400 text-sm"></i>
                        </div>
                        <input 
                            type="text" 
                            id="search-input-desktop"
                            placeholder="Buscar produto..." 
                            class="w-full pl-11 pr-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 transition-all text-sm bg-slate-50/50"
                        >
                    </div>
                    
                    <!-- Categories -->
                    <div>
                        <h2 class="text-base font-semibold text-slate-900 mb-3">Categorias</h2>
                        <nav class="space-y-1" id="desktop-categories">
                            <!-- Categories will be populated by JavaScript -->
                        </nav>
                    </div>
                    
                    <!-- Cart Button -->
                    <div class="pt-4 border-t border-slate-200">
                        <button class="w-full relative btn-primary text-white px-4 py-3.5 rounded-xl font-medium shadow-sm" id="cart-btn-desktop">
                            <i class="fas fa-shopping-cart mr-2 text-sm"></i>
                            Ver Carrinho
                            <span id="cart-count-desktop" class="absolute -top-1.5 -right-1.5 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden font-semibold">0</span>
                        </button>
                    </div>
                </div>
            </div>
        </aside>
        
        <!-- Desktop Main Content -->
        <main class="flex-1 bg-slate-50 overflow-y-auto custom-scrollbar">
            <div class="max-w-7xl mx-auto px-8 py-8">
                <!-- Menu Items Container -->
                <div id="menu-items-desktop" class="grid grid-cols-1 xl:grid-cols-2 2xl:grid-cols-3 gap-5">
                    <!-- Menu items will be populated by JavaScript -->
                </div>
            </div>
        </main>
    </div>

    <!-- Mobile Main Content -->
    <main class="lg:hidden px-4 py-5">
        <div class="grid grid-cols-1 gap-4" id="menu-items-mobile">
            <!-- Menu items will be populated by JavaScript -->
        </div>
    </main>

    <!-- Cart Sidebar - Desktop -->
    <div id="cart-sidebar-desktop" class="hidden sm:block fixed inset-y-0 right-0 w-80 bg-white shadow-2xl transform translate-x-full transition-transform duration-300 z-50 border-l border-slate-200">
        <div class="flex flex-col h-full">
            <div class="flex items-center justify-between p-5 border-b border-slate-200">
                <h2 class="text-lg font-semibold text-slate-900">Seu Pedido</h2>
                <button class="text-slate-400 hover:text-slate-600 transition-colors p-1 hover:bg-slate-100 rounded-lg" id="close-cart-desktop">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
            
            <div class="flex-1 overflow-y-auto p-5 custom-scrollbar">
                <div id="cart-items-desktop" class="space-y-3">
                    <!-- Cart items will be populated by JavaScript -->
                </div>
                
                <div id="empty-cart-desktop" class="text-center py-12">
                    <i class="fas fa-shopping-cart text-slate-300 text-3xl mb-3"></i>
                    <p class="text-slate-500 text-sm">Seu carrinho est√° vazio</p>
                </div>
            </div>
            
            <div class="border-t border-slate-200 p-5 space-y-4 bg-slate-50/50">
                <div class="flex justify-between text-base font-semibold">
                    <span class="text-slate-900">Total:</span>
                    <span id="cart-total-desktop" class="text-orange-600">R$ 0,00</span>
                </div>
                <button class="w-full btn-primary text-white py-2.5 rounded-xl font-medium shadow-sm text-sm" id="checkout-btn-desktop">
                    <i class="fas fa-credit-card mr-2 text-xs"></i>Finalizar Pedido
                </button>
            </div>
        </div>
    </div>

    <!-- Cart Modal - Mobile -->
    <div id="cart-modal-mobile" class="sm:hidden fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" id="cart-overlay-mobile"></div>
        <div id="cart-content-mobile" class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-2xl transform translate-y-full transition-transform duration-300 max-h-[80vh] flex flex-col">
            <div class="flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-2xl">
                <h2 class="text-base font-semibold text-slate-900">Seu Pedido</h2>
                <button class="text-slate-400 hover:text-slate-600 transition-colors p-1 hover:bg-slate-100 rounded-lg" id="close-cart-mobile">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
            
            <div class="flex-1 overflow-y-auto p-4 min-h-0">
                <div id="cart-items-mobile" class="space-y-3">
                    <!-- Cart items will be populated by JavaScript -->
                </div>
                
                <div id="empty-cart-mobile" class="text-center py-8">
                    <i class="fas fa-shopping-cart text-slate-300 text-2xl mb-2"></i>
                    <p class="text-slate-500 text-sm">Seu carrinho est√° vazio</p>
                </div>
            </div>
            
            <div class="border-t border-slate-200 p-4 space-y-3 bg-slate-50/50">
                <div class="flex justify-between text-base font-semibold">
                    <span class="text-slate-900">Total:</span>
                    <span id="cart-total-mobile" class="text-orange-600">R$ 0,00</span>
                </div>
                <button class="w-full btn-primary text-white py-2.5 rounded-xl font-medium shadow-sm text-sm" id="checkout-btn-mobile">
                    <i class="fas fa-credit-card mr-2 text-xs"></i>Finalizar Pedido
                </button>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="product-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
        <!-- Mobile Layout -->
        <div id="product-modal-mobile" class="sm:hidden absolute inset-0">
            <div class="absolute inset-0" id="product-modal-overlay-mobile"></div>
            <div id="product-modal-content-mobile" class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-2xl transform translate-y-full transition-transform duration-300 max-h-[85vh] flex flex-col">
                <div id="modal-content-mobile" class="flex-1 min-h-0 flex flex-col">
                    <!-- Modal content will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Desktop Layout -->
        <div id="product-modal-desktop" class="hidden sm:flex items-center justify-center p-6">
            <div class="bg-white rounded-2xl w-full max-w-4xl slide-up shadow-2xl max-h-[90vh] flex border border-slate-200">
                <div id="modal-content-desktop" class="flex-1 min-h-0 flex">
                    <!-- Modal content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Restaurant Modal -->
    <div id="restaurant-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
        <!-- Mobile Layout -->
        <div id="restaurant-modal-mobile" class="sm:hidden absolute inset-0">
            <div class="absolute inset-0" id="restaurant-modal-overlay-mobile"></div>
            <div id="restaurant-modal-content-mobile" class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-2xl transform translate-y-full transition-transform duration-300 max-h-[90vh] flex flex-col">
                <div id="restaurant-content-mobile" class="flex-1 min-h-0 flex flex-col">
                    <!-- Modal content will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Desktop Layout -->
        <div id="restaurant-modal-desktop" class="hidden sm:flex items-center justify-center p-6">
            <div class="bg-white rounded-2xl w-full max-w-4xl slide-up shadow-2xl max-h-[90vh] flex flex-col border border-slate-200">
                <div id="restaurant-content-desktop" class="flex-1 min-h-0 flex flex-col">
                    <!-- Modal content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkout-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
        <!-- Mobile Layout -->
        <div id="checkout-modal-mobile" class="sm:hidden absolute inset-0">
            <div class="absolute inset-0" id="checkout-modal-overlay-mobile"></div>
            <div id="checkout-modal-content-mobile" class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-2xl transform translate-y-full transition-transform duration-300 max-h-[90vh] flex flex-col">
                <div id="checkout-content-mobile" class="flex-1 min-h-0 flex flex-col">
                    <!-- Modal content will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Desktop Layout -->
        <div id="checkout-modal-desktop" class="hidden sm:flex items-center justify-center p-6">
            <div class="bg-white rounded-2xl w-full max-w-2xl slide-up shadow-2xl max-h-[90vh] flex flex-col border border-slate-200">
                <div id="checkout-content-desktop" class="flex-1 min-h-0 flex flex-col">
                    <!-- Modal content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-6 left-1/2 transform -translate-x-1/2 translate-y-[calc(100%+2rem)] bg-emerald-500 text-white px-4 py-2.5 rounded-lg shadow-2xl transition-all duration-300 z-50 whitespace-nowrap">
        <div class="flex items-center space-x-2">
            <div class="flex-shrink-0">
                <i id="toast-icon" class="fas fa-check-circle text-sm"></i>
            </div>
            <span id="toast-message" class="font-medium text-sm">Produto adicionado ao carrinho!</span>
        </div>
    </div>

    <script>
        // Sistema de Card√°pio Digital
        class MenuApp {
            constructor() {
                this.state = {
                    cart: [],
                    currentCategory: 'all',
                    currentSearchTerm: '',
                    currentProduct: null,
                    modalSelections: { quantity: 1 },
                    isCartOpen: false,
                    editingCartItemId: null
                };

                this.categories = [
                    { key: 'all', name: 'Todos', icon: 'fas fa-th-large' },
                    { key: 'burgers', name: 'Hamb√∫rguers', emoji: 'üçî' },
                    { key: 'pizzas', name: 'Pizzas', emoji: 'üçï' },
                    { key: 'drinks', name: 'Bebidas', emoji: 'ü•§' },
                    { key: 'desserts', name: 'Sobremesas', emoji: 'üç∞' }
                ];

                this.restaurantData = {
                    name: "Restaurante Sabor",
                    rating: 4.8,
                    reviewCount: 247,
                    description: "H√° mais de 15 anos servindo os melhores sabores da cidade. Nossa cozinha combina tradi√ß√£o familiar com ingredientes frescos e selecionados, criando experi√™ncias gastron√¥micas √∫nicas e inesquec√≠veis.",
                    social: {
                        instagram: "@restaurantesabor",
                        facebook: "RestauranteSabor",
                        whatsapp: "(11) 99999-9999"
                    },
                    photos: [
                        { id: 1, description: "Ambiente aconchegante", emoji: "üè†" },
                        { id: 2, description: "Cozinha aberta", emoji: "üë®‚Äçüç≥" },
                        { id: 3, description: "√Årea externa", emoji: "üåø" },
                        { id: 4, description: "Sal√£o principal", emoji: "üçΩÔ∏è" }
                    ],
                    hours: {
                        monday: { open: "11:00", close: "23:00", closed: false },
                        tuesday: { open: "11:00", close: "23:00", closed: false },
                        wednesday: { open: "11:00", close: "23:00", closed: false },
                        thursday: { open: "11:00", close: "23:00", closed: false },
                        friday: { open: "11:00", close: "00:00", closed: false },
                        saturday: { open: "11:00", close: "00:00", closed: false },
                        sunday: { open: "11:00", close: "22:00", closed: false }
                    }
                };

                this.menuData = {
                    burgers: [
                        { 
                            id: 1, 
                            name: "X-Salada", 
                            description: "Hamb√∫rguer bovino, queijo, alface, tomate, cebola e maionese", 
                            price: 18.90, 
                            icon: "ü•ó", 
                            category: "burgers",
                            options: {
                                size: {
                                    name: "TAMANHO",
                                    type: "radio",
                                    required: true,
                                    items: [
                                        { id: "normal", name: "Normal", description: "150g", price: 0 },
                                        { id: "grande", name: "Grande", description: "250g", price: 5.00 }
                                    ]
                                },
                                extras: {
                                    name: "ADICIONAIS",
                                    type: "checkbox",
                                    required: false,
                                    items: [
                                        { id: "bacon", name: "Bacon", description: "Crocante", price: 3.50 },
                                        { id: "queijo", name: "Queijo extra", description: "Fatia dupla", price: 2.50 },
                                        { id: "ovo", name: "Ovo", description: "Frito", price: 2.00 },
                                        { id: "batata", name: "Batata palha", description: "Crocante", price: 1.50 }
                                    ]
                                }
                            }
                        },
                        { 
                            id: 2, 
                            name: "X-Bacon", 
                            description: "Hamb√∫rguer bovino, queijo, bacon crocante, alface, tomate e maionese", 
                            price: 22.90, 
                            icon: "ü•ì", 
                            category: "burgers"
                        },
                        { 
                            id: 3, 
                            name: "X-Egg", 
                            description: "Hamb√∫rguer bovino, queijo, ovo frito, alface, tomate e maionese", 
                            price: 20.90, 
                            icon: "üç≥", 
                            category: "burgers"
                        }
                    ],
                    pizzas: [
                        { 
                            id: 7, 
                            name: "Pizza Margherita", 
                            description: "Molho de tomate, mussarela, tomate e manjeric√£o fresco", 
                            price: 28.90, 
                            icon: "üçï", 
                            category: "pizzas",
                            options: {
                                size: {
                                    name: "TAMANHO",
                                    type: "radio",
                                    required: true,
                                    items: [
                                        { id: "pequena", name: "Pequena", description: "25cm ‚Ä¢ 4 fatias", price: 0 },
                                        { id: "media", name: "M√©dia", description: "30cm ‚Ä¢ 6 fatias", price: 8.00 },
                                        { id: "grande", name: "Grande", description: "35cm ‚Ä¢ 8 fatias", price: 15.00 }
                                    ]
                                }
                            }
                        },
                        { 
                            id: 8, 
                            name: "Pizza Calabresa", 
                            description: "Molho de tomate, mussarela, calabresa e cebola", 
                            price: 32.90, 
                            icon: "üçï", 
                            category: "pizzas"
                        }
                    ],
                    drinks: [
                        { id: 13, name: "Coca-Cola", description: "Refrigerante Coca-Cola gelado - lata 350ml", price: 4.90, icon: "ü•§", category: "drinks" },
                        { id: 14, name: "Suco de Laranja", description: "Suco natural de laranja feito na hora - 300ml", price: 7.90, icon: "üßÉ", category: "drinks" },
                        { id: 15, name: "√Ågua Mineral", description: "√Ågua mineral gelada - garrafa 500ml", price: 2.90, icon: "üíß", category: "drinks" }
                    ],
                    desserts: [
                        { id: 19, name: "Cookie de Chocolate", description: "Cookie artesanal de chocolate crocante por fora e macio por dentro", price: 5.90, icon: "üç™", category: "desserts" },
                        { id: 20, name: "Brownie com Sorvete", description: "Brownie de chocolate com nozes servido quente com sorvete de baunilha", price: 12.90, icon: "üç´", category: "desserts" },
                        { id: 21, name: "Pudim de Leite", description: "Pudim de leite condensado com calda de caramelo", price: 7.90, icon: "üçÆ", category: "desserts" }
                    ]
                };

                this.init();
            }

            // Utilit√°rios
            formatPrice(price) {
                return price.toFixed(2).replace('.', ',');
            }

            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            // Inicializa√ß√£o
            init() {
                this.setupEventListeners();
                this.renderCategories();
                this.renderMenuItems();
                this.updateCartDisplay();
            }

            setupEventListeners() {
                // Search inputs
                document.getElementById('search-input-mobile')?.addEventListener('input', this.debounce(() => this.handleSearch(), 300));
                document.getElementById('search-input-desktop')?.addEventListener('input', this.debounce(() => this.handleSearch(), 300));

                // Cart buttons
                document.getElementById('cart-btn-mobile')?.addEventListener('click', () => this.toggleCart());
                document.getElementById('cart-btn-desktop')?.addEventListener('click', () => this.toggleCart());

                // Close cart buttons
                document.getElementById('close-cart-mobile')?.addEventListener('click', () => this.toggleCart());
                document.getElementById('close-cart-desktop')?.addEventListener('click', () => this.toggleCart());
                document.getElementById('cart-overlay-mobile')?.addEventListener('click', () => this.toggleCart());

                // Product modal close
                document.getElementById('product-modal-overlay-mobile')?.addEventListener('click', () => this.closeProductModal());

                // Checkout buttons
                document.getElementById('checkout-btn-mobile')?.addEventListener('click', () => this.openCheckoutModal());
                document.getElementById('checkout-btn-desktop')?.addEventListener('click', () => this.openCheckoutModal());

                // Restaurant modal close
                document.getElementById('restaurant-modal-overlay-mobile')?.addEventListener('click', () => this.closeRestaurantModal());

                // Checkout modal close
                document.getElementById('checkout-modal-overlay-mobile')?.addEventListener('click', () => this.closeCheckoutModal());

                // Modal close on escape
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeProductModal();
                        this.closeRestaurantModal();
                        this.closeCheckoutModal();
                        if (this.state.isCartOpen) this.toggleCart();
                    }
                });
            }

            handleSearch() {
                const searchMobile = document.getElementById('search-input-mobile');
                const searchDesktop = document.getElementById('search-input-desktop');
                
                let searchTerm = '';
                
                if (searchMobile && document.activeElement === searchMobile) {
                    searchTerm = searchMobile.value.trim();
                    if (searchDesktop) searchDesktop.value = searchTerm;
                } else if (searchDesktop && document.activeElement === searchDesktop) {
                    searchTerm = searchDesktop.value.trim();
                    if (searchMobile) searchMobile.value = searchTerm;
                }
                
                this.state.currentSearchTerm = searchTerm;
                this.renderMenuItems();
            }

            // Renderiza√ß√£o de categorias
            renderCategories() {
                const mobileContainer = document.getElementById('mobile-categories');
                const desktopContainer = document.getElementById('desktop-categories');
                
                if (mobileContainer) {
                    mobileContainer.innerHTML = '';
                    this.categories.forEach(category => {
                        mobileContainer.appendChild(this.createMobileCategoryButton(category));
                    });
                }
                
                if (desktopContainer) {
                    desktopContainer.innerHTML = '';
                    this.categories.forEach(category => {
                        desktopContainer.appendChild(this.createDesktopCategoryButton(category));
                    });
                }
            }

            createMobileCategoryButton(category) {
                const button = document.createElement('button');
                const isActive = this.state.currentCategory === category.key;
                
                button.className = `flex-shrink-0 px-4 py-2 rounded-full text-xs font-medium transition-all duration-200 ${
                    isActive 
                        ? 'bg-orange-500 text-white shadow-sm' 
                        : 'text-slate-700 bg-slate-100 hover:bg-orange-100 hover:text-orange-600'
                }`;
                
                const iconHtml = category.icon 
                    ? `<i class="${category.icon} mr-1.5 text-xs"></i>`
                    : category.emoji 
                        ? `<span class="mr-1.5 text-xs">${category.emoji}</span>`
                        : '';
                
                button.innerHTML = `${iconHtml}${category.name}`;
                button.addEventListener('click', () => this.filterCategory(category.key));
                
                return button;
            }

            createDesktopCategoryButton(category) {
                const button = document.createElement('button');
                const isActive = this.state.currentCategory === category.key;
                
                button.className = `w-full text-left px-3 py-2.5 rounded-lg transition-all duration-200 text-sm ${
                    isActive 
                        ? 'bg-orange-500 text-white shadow-sm' 
                        : 'text-slate-700 hover:bg-orange-50 hover:text-orange-600'
                }`;
                
                const iconHtml = category.icon 
                    ? `<i class="${category.icon} mr-2.5 w-4 text-xs"></i>`
                    : category.emoji 
                        ? `<span class="mr-2.5 w-4 inline-block text-center text-xs">${category.emoji}</span>`
                        : '';
                
                button.innerHTML = `${iconHtml}${category.name === 'Todos' ? 'Todos os Produtos' : category.name}`;
                button.addEventListener('click', () => this.filterCategory(category.key));
                
                return button;
            }

            // Renderiza√ß√£o do menu
            renderMenuItems() {
                const containerDesktop = document.getElementById('menu-items-desktop');
                const containerMobile = document.getElementById('menu-items-mobile');
                
                if (!containerDesktop || !containerMobile) return;
                
                containerDesktop.innerHTML = '';
                containerMobile.innerHTML = '';
                
                const allItems = Object.values(this.menuData).flat();
                let itemsToShow = this.state.currentCategory === 'all' ? allItems : (this.menuData[this.state.currentCategory] || []);
                
                if (this.state.currentSearchTerm) {
                    itemsToShow = itemsToShow.filter(item => 
                        item.name.toLowerCase().includes(this.state.currentSearchTerm.toLowerCase()) ||
                        item.description.toLowerCase().includes(this.state.currentSearchTerm.toLowerCase())
                    );
                }

                if (this.state.currentCategory === 'all' && !this.state.currentSearchTerm) {
                    this.renderAllCategories(containerDesktop, containerMobile);
                } else {
                    itemsToShow.forEach(item => {
                        containerDesktop.appendChild(this.createItemElement(item));
                        containerMobile.appendChild(this.createItemElement(item));
                    });
                }
            }

            renderAllCategories(containerDesktop, containerMobile) {
                const categories = [
                    { key: 'burgers', name: 'üçî Hamb√∫rguers', items: this.menuData.burgers },
                    { key: 'pizzas', name: 'üçï Pizzas', items: this.menuData.pizzas },
                    { key: 'drinks', name: 'ü•§ Bebidas', items: this.menuData.drinks },
                    { key: 'desserts', name: 'üç∞ Sobremesas', items: this.menuData.desserts }
                ];

                categories.forEach(category => {
                    const headerDesktop = this.createSectionHeader(category.name);
                    const headerMobile = this.createSectionHeader(category.name);
                    
                    containerDesktop.appendChild(headerDesktop);
                    containerMobile.appendChild(headerMobile);

                    category.items.forEach(item => {
                        containerDesktop.appendChild(this.createItemElement(item));
                        containerMobile.appendChild(this.createItemElement(item));
                    });
                });
            }

            createSectionHeader(name) {
                const header = document.createElement('div');
                header.className = 'col-span-full mb-4';
                header.innerHTML = `
                    <div class="flex items-center mt-6">
                        <h2 class="text-lg font-semibold text-slate-800">${name}</h2>
                        <div class="flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent ml-4"></div>
                    </div>
                `;
                return header;
            }

            createItemElement(item) {
                const itemElement = document.createElement('div');
                itemElement.className = 'bg-white rounded-xl shadow-sm premium-card cursor-pointer fade-in border border-slate-100';
                itemElement.addEventListener('click', () => this.openProductModal(item));

                itemElement.innerHTML = `
                    <div class="hidden md:block p-5">
                        <div class="w-full aspect-[5/2] bg-gradient-to-br from-slate-100 to-slate-200 rounded-lg overflow-hidden mb-4 flex items-center justify-center">
                            <span class="text-5xl">${item.icon}</span>
                        </div>
                        <div class="mb-2">
                            <h3 class="text-base font-semibold inline text-slate-900">${item.name}</h3>
                            <span class="text-slate-300 mx-2">‚Ä¢</span>
                            <span class="text-base font-bold text-orange-600">R$ ${this.formatPrice(item.price)}</span>
                        </div>
                        <p class="text-slate-600 text-xs line-clamp-2 leading-relaxed">${item.description}</p>
                    </div>
                    
                    <div class="md:hidden p-4">
                        <div class="flex space-x-3">
                            <div class="w-16 aspect-square bg-gradient-to-br from-slate-100 to-slate-200 rounded-lg overflow-hidden flex-shrink-0 flex items-center justify-center">
                                <span class="text-2xl">${item.icon}</span>
                            </div>
                            <div class="flex-1">
                                <div class="mb-1">
                                    <h3 class="text-sm font-semibold inline text-slate-900">${item.name}</h3>
                                    <span class="text-slate-300 mx-1">‚Ä¢</span>
                                    <span class="text-sm font-bold text-orange-600">R$ ${this.formatPrice(item.price)}</span>
                                </div>
                                <p class="text-slate-600 text-xs line-clamp-2 leading-relaxed">${item.description}</p>
                            </div>
                        </div>
                    </div>
                `;

                return itemElement;
            }

            // Filtros e categorias
            filterCategory(category) {
                this.state.currentCategory = category;
                this.renderCategories();
                this.renderMenuItems();
            }

            // Gera√ß√£o de op√ß√µes do produto
            generateProductOptions(item) {
                if (!item.options || Object.keys(item.options).length === 0) {
                    return `
                        <div class="text-center py-8">
                            <div class="text-slate-300 mb-2">
                                <i class="fas fa-check-circle text-2xl"></i>
                            </div>
                            <p class="text-xs text-slate-500">Este produto n√£o possui op√ß√µes adicionais</p>
                        </div>
                    `;
                }

                let optionsHtml = '';
                
                Object.entries(item.options).forEach(([optionKey, option]) => {
                    optionsHtml += `
                        <div class="mb-5">
                            <div class="mb-3">
                                <div class="flex items-center space-x-2">
                                    <h4 class="text-xs font-semibold text-slate-900 uppercase tracking-wide">${option.name}</h4>
                                    <span class="text-slate-300">‚Ä¢</span>
                                    ${option.required ? 
                                        '<span class="text-xs text-red-600 font-medium bg-red-50 px-2 py-0.5 rounded-full">Obrigat√≥rio</span>' : 
                                        '<span class="text-xs text-green-600 font-medium bg-green-50 px-2 py-0.5 rounded-full">Opcional</span>'
                                    }
                                </div>
                            </div>
                            
                            <div class="space-y-2">
                    `;
                    
                    option.items.forEach((optionItem, index) => {
                        const inputType = option.type === 'radio' ? 'radio' : 'checkbox';
                        const inputName = option.type === 'radio' ? `option_${optionKey}` : `option_${optionKey}_${optionItem.id}`;
                        const isDefaultSelected = option.type === 'radio' && optionItem.id === option.items[0].id;
                        const hasPrice = optionItem.price > 0;
                        const uniqueId = `${optionKey}_${optionItem.id}_${Date.now()}`;
                        
                        optionsHtml += `
                            <label for="${uniqueId}" class="option-item flex items-center justify-between p-3 rounded-lg cursor-pointer group">
                                <div class="flex items-center space-x-3 flex-1">
                                    <input 
                                        type="${inputType}" 
                                        id="${uniqueId}"
                                        name="${inputName}" 
                                        value="${optionItem.id}" 
                                        data-price="${optionItem.price}"
                                        data-option-key="${optionKey}"
                                        class="w-3.5 h-3.5 text-blue-500 border-slate-300 focus:ring-blue-500/20 focus:ring-2"
                                        onchange="app.updateOptionSelection()"
                                        ${isDefaultSelected ? 'checked' : ''}
                                    >
                                    <div class="flex-1">
                                        <div class="text-xs font-medium text-slate-900">
                                            ${optionItem.name}${optionItem.description ? ` ‚Ä¢ <span class="text-slate-400">${optionItem.description}</span>` : ''}
                                        </div>
                                    </div>
                                </div>
                                <div class="text-right">
                                    ${hasPrice ? 
                                        `<div class="text-xs font-semibold text-orange-600">R$ ${this.formatPrice(optionItem.price)}</div>` : 
                                        '<div class="text-xs text-slate-400">R$ 0,00</div>'
                                    }
                                </div>
                            </label>
                        `;
                    });
                    
                    optionsHtml += `
                            </div>
                        </div>
                    `;
                });
                
                return optionsHtml;
            }

            // Modal do produto
            openProductModal(item) {
                this.state.currentProduct = item;
                this.state.modalSelections = { quantity: 1 };
                this.state.editingCartItemId = null;
                
                // Initialize default selections for required options
                if (item.options) {
                    Object.entries(item.options).forEach(([optionKey, option]) => {
                        if (option.type === 'radio' && option.items.length > 0) {
                            this.state.modalSelections[optionKey] = option.items[0].id;
                        }
                    });
                }
                
                const modal = document.getElementById('product-modal');
                if (!modal) return;
                
                const isMobile = window.innerWidth < 640;
                
                if (isMobile) {
                    this.showMobileModal(item);
                } else {
                    this.showDesktopModal(item);
                }
                
                modal.classList.remove('hidden');
            }

            showMobileModal(item) {
                const mobileModal = document.getElementById('product-modal-mobile');
                const desktopModal = document.getElementById('product-modal-desktop');
                const modalContent = document.getElementById('modal-content-mobile');
                
                if (mobileModal) mobileModal.classList.remove('hidden');
                if (desktopModal) desktopModal.classList.add('hidden');
                if (modalContent) modalContent.innerHTML = this.generateMobileModalContent(item);
                
                setTimeout(() => {
                    const mobileContent = document.getElementById('product-modal-content-mobile');
                    if (mobileContent) mobileContent.classList.remove('translate-y-full');
                }, 10);
            }

            showDesktopModal(item) {
                const mobileModal = document.getElementById('product-modal-mobile');
                const desktopModal = document.getElementById('product-modal-desktop');
                const modalContent = document.getElementById('modal-content-desktop');
                
                if (mobileModal) mobileModal.classList.add('hidden');
                if (desktopModal) desktopModal.classList.remove('hidden');
                if (modalContent) modalContent.innerHTML = this.generateDesktopModalContent(item);
            }

            generateMobileModalContent(item) {
                const optionsHtml = this.generateProductOptions(item);
                const buttonText = this.state.editingCartItemId ? 'Atualizar' : 'Adicionar';
                
                return `
                    <div class="flex items-center justify-between px-4 py-3 border-b border-slate-200 bg-white rounded-t-2xl">
                        <h2 class="text-base font-semibold text-slate-900">${item.name}</h2>
                        <button class="text-slate-400 hover:text-slate-600 transition-colors p-1 hover:bg-slate-100 rounded-lg" onclick="app.closeProductModal()">
                            <i class="fas fa-times text-base"></i>
                        </button>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto">
                        <div class="px-4 py-4">
                            <div class="w-full aspect-[5/2] bg-gradient-to-br from-slate-100 to-slate-200 rounded-xl flex items-center justify-center mb-4">
                                <span class="text-5xl">${item.icon}</span>
                            </div>
                            
                            <div class="mb-4">
                                <p class="text-slate-600 text-xs leading-relaxed">${item.description}</p>
                            </div>
                            
                            ${item.options && Object.keys(item.options).length > 0 ? `
                                <div class="mb-4">
                                    <h3 class="text-sm font-semibold text-slate-900 mb-3">Personalize seu pedido</h3>
                                    ${optionsHtml}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div class="p-4 bg-slate-50/50 border-t border-slate-200">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center space-x-2">
                                <span class="text-xs font-medium text-slate-900">Quantidade:</span>
                                <div class="flex items-center space-x-2">
                                    <button class="quantity-btn w-6 h-6 bg-slate-200 hover:bg-slate-300 rounded-full flex items-center justify-center transition-all" onclick="app.updateQuantity(-1)">
                                        <i class="fas fa-minus text-xs text-slate-600"></i>
                                    </button>
                                    <span id="quantity-display" class="text-xs font-semibold text-slate-900 w-4 text-center">${this.state.modalSelections.quantity}</span>
                                    <button class="quantity-btn w-6 h-6 bg-orange-500 hover:bg-orange-600 text-white rounded-full flex items-center justify-center transition-all" onclick="app.updateQuantity(1)">
                                        <i class="fas fa-plus text-xs"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="text-xs font-medium text-slate-900">Valor:</span>
                                <span id="individual-price" class="text-xs font-bold text-orange-600">R$ ${this.formatPrice(item.price)}</span>
                            </div>
                        </div>
                        
                        <button class="w-full btn-primary text-white font-medium py-2.5 rounded-lg transition-all shadow-sm text-sm" onclick="app.addToCart()">
                            <i class="fas fa-shopping-cart mr-2 text-xs"></i>${buttonText} ‚Ä¢ <span id="total-price">R$ ${this.formatPrice(item.price)}</span>
                        </button>
                    </div>
                `;
            }

            generateDesktopModalContent(item) {
                const optionsHtml = this.generateProductOptions(item);
                const buttonText = this.state.editingCartItemId ? 'Atualizar' : 'Adicionar';
                
                return `
                    <div class="w-2/5 bg-white border-r border-slate-100 flex flex-col">
                        <div class="p-6 border-b border-slate-100">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-xl font-semibold text-slate-900">${item.name}</h2>
                                <button class="text-slate-400 hover:text-slate-600 transition-colors p-2 hover:bg-slate-100 rounded-lg" onclick="app.closeProductModal()">
                                    <i class="fas fa-times text-base"></i>
                                </button>
                            </div>
                            
                            <div class="w-full aspect-[5/2] bg-gradient-to-br from-slate-100 to-slate-200 rounded-xl flex items-center justify-center mb-4 shadow-sm">
                                <span class="text-6xl">${item.icon}</span>
                            </div>
                            
                            <p class="text-slate-600 leading-relaxed text-xs">${item.description}</p>
                        </div>
                        
                        <div class="p-6 mt-auto">
                            <div class="flex items-center justify-between mb-4 p-3 bg-slate-50 rounded-lg border border-slate-100">
                                <div class="flex items-center space-x-3">
                                    <span class="text-xs font-medium text-slate-900">Quantidade:</span>
                                    <div class="flex items-center space-x-2">
                                        <button class="quantity-btn w-7 h-7 bg-white hover:bg-slate-100 rounded-full flex items-center justify-center transition-all border border-slate-200 shadow-sm" onclick="app.updateQuantity(-1)">
                                            <i class="fas fa-minus text-xs text-slate-600"></i>
                                        </button>
                                        <span id="quantity-display" class="text-sm font-semibold text-slate-900 w-5 text-center">${this.state.modalSelections.quantity}</span>
                                        <button class="quantity-btn w-7 h-7 bg-orange-500 hover:bg-orange-600 text-white rounded-full flex items-center justify-center transition-all shadow-sm" onclick="app.updateQuantity(1)">
                                            <i class="fas fa-plus text-xs"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-xs text-slate-500">Pre√ßo unit√°rio</div>
                                    <span id="individual-price" class="text-sm font-bold text-orange-600">R$ ${this.formatPrice(item.price)}</span>
                                </div>
                            </div>
                            
                            <button class="w-full btn-primary text-white font-medium py-2.5 rounded-xl transition-all shadow-sm text-sm" onclick="app.addToCart()">
                                <i class="fas fa-shopping-cart mr-2 text-xs"></i>${buttonText} ‚Ä¢ <span id="total-price">R$ ${this.formatPrice(item.price)}</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="flex-1 bg-slate-50 flex flex-col">
                        <div class="p-6 border-b border-slate-200 bg-white">
                            <h3 class="text-base font-semibold text-slate-900">Personalize seu pedido</h3>
                            <p class="text-xs text-slate-500 mt-1">Escolha os opcionais e adicionais</p>
                        </div>
                        
                        <div class="flex-1 overflow-y-auto p-6 custom-scrollbar">
                            ${optionsHtml}
                        </div>
                    </div>
                `;
            }

            closeProductModal() {
                const modal = document.getElementById('product-modal');
                if (!modal) return;
                
                const isMobile = window.innerWidth < 640;
                
                if (isMobile) {
                    const mobileContent = document.getElementById('product-modal-content-mobile');
                    if (mobileContent) mobileContent.classList.add('translate-y-full');
                    setTimeout(() => modal.classList.add('hidden'), 300);
                } else {
                    modal.classList.add('hidden');
                }
                
                this.state.currentProduct = null;
                this.state.editingCartItemId = null;
            }

            updateQuantity(change) {
                const newQuantity = Math.max(1, this.state.modalSelections.quantity + change);
                this.state.modalSelections.quantity = newQuantity;
                
                const quantityDisplay = document.getElementById('quantity-display');
                if (quantityDisplay) quantityDisplay.textContent = newQuantity;
                
                this.updatePriceSummary();
            }

            updateOptionSelection() {
                if (!this.state.currentProduct) return;
                
                // Update modal selections based on form inputs
                const inputs = document.querySelectorAll('#product-modal input[type="radio"]:checked, #product-modal input[type="checkbox"]:checked');
                
                // Reset selections except quantity
                const quantity = this.state.modalSelections.quantity;
                this.state.modalSelections = { quantity };
                
                inputs.forEach(input => {
                    const optionKey = input.dataset.optionKey;
                    const value = input.value;
                    
                    if (input.type === 'radio') {
                        this.state.modalSelections[optionKey] = value;
                    } else if (input.type === 'checkbox') {
                        if (!this.state.modalSelections[optionKey]) {
                            this.state.modalSelections[optionKey] = [];
                        }
                        if (input.checked) {
                            this.state.modalSelections[optionKey].push(value);
                        }
                    }
                });
                
                // Update visual states
                document.querySelectorAll('.option-item').forEach(item => {
                    const input = item.querySelector('input');
                    if (input && input.checked) {
                        item.classList.add('selected');
                    } else {
                        item.classList.remove('selected');
                    }
                });
                
                this.updatePriceSummary();
            }

            updatePriceSummary() {
                if (!this.state.currentProduct) return;
                
                let basePrice = this.state.currentProduct.price;
                let optionsPrice = 0;
                
                // Calculate options price
                if (this.state.currentProduct.options) {
                    Object.entries(this.state.currentProduct.options).forEach(([optionKey, option]) => {
                        const selection = this.state.modalSelections[optionKey];
                        
                        if (option.type === 'radio' && selection) {
                            const selectedItem = option.items.find(item => item.id === selection);
                            if (selectedItem) optionsPrice += selectedItem.price;
                        } else if (option.type === 'checkbox' && Array.isArray(selection)) {
                            selection.forEach(selectedId => {
                                const selectedItem = option.items.find(item => item.id === selectedId);
                                if (selectedItem) optionsPrice += selectedItem.price;
                            });
                        }
                    });
                }
                
                const unitPrice = basePrice + optionsPrice;
                const finalPrice = unitPrice * this.state.modalSelections.quantity;
                
                const individualPriceElement = document.getElementById('individual-price');
                const totalPriceElement = document.getElementById('total-price');
                
                if (individualPriceElement) individualPriceElement.textContent = `R$ ${this.formatPrice(unitPrice)}`;
                if (totalPriceElement) totalPriceElement.textContent = `R$ ${this.formatPrice(finalPrice)}`;
            }

            addToCart() {
                if (!this.state.currentProduct) return;
                
                let basePrice = this.state.currentProduct.price;
                let optionsPrice = 0;
                let optionsDescription = [];
                
                // Calculate options price and build description
                if (this.state.currentProduct.options) {
                    Object.entries(this.state.currentProduct.options).forEach(([optionKey, option]) => {
                        const selection = this.state.modalSelections[optionKey];
                        
                        if (option.type === 'radio' && selection) {
                            const selectedItem = option.items.find(item => item.id === selection);
                            if (selectedItem) {
                                optionsPrice += selectedItem.price;
                                if (selectedItem.id !== option.items[0].id) { // Only show if not default
                                    optionsDescription.push(selectedItem.name);
                                }
                            }
                        } else if (option.type === 'checkbox' && Array.isArray(selection)) {
                            selection.forEach(selectedId => {
                                const selectedItem = option.items.find(item => item.id === selectedId);
                                if (selectedItem) {
                                    optionsPrice += selectedItem.price;
                                    optionsDescription.push(selectedItem.name);
                                }
                            });
                        }
                    });
                }
                
                const unitPrice = basePrice + optionsPrice;
                const finalPrice = unitPrice * this.state.modalSelections.quantity;
                
                // Check if we're editing an existing item
                if (this.state.editingCartItemId) {
                    // Update existing item
                    const itemIndex = this.state.cart.findIndex(item => item.id === this.state.editingCartItemId);
                    if (itemIndex !== -1) {
                        this.state.cart[itemIndex] = {
                            id: this.state.editingCartItemId,
                            productId: this.state.currentProduct.id,
                            name: this.state.currentProduct.name,
                            basePrice: this.state.currentProduct.price,
                            unitPrice: unitPrice,
                            quantity: this.state.modalSelections.quantity,
                            totalPrice: finalPrice,
                            icon: this.state.currentProduct.icon,
                            options: optionsDescription.length > 0 ? optionsDescription : null,
                            selections: { ...this.state.modalSelections }
                        };
                        this.showToast('Produto atualizado no carrinho!', 'success');
                    }
                    this.state.editingCartItemId = null;
                } else {
                    // Add new item
                    const cartItem = {
                        id: Date.now(),
                        productId: this.state.currentProduct.id,
                        name: this.state.currentProduct.name,
                        basePrice: this.state.currentProduct.price,
                        unitPrice: unitPrice,
                        quantity: this.state.modalSelections.quantity,
                        totalPrice: finalPrice,
                        icon: this.state.currentProduct.icon,
                        options: optionsDescription.length > 0 ? optionsDescription : null,
                        selections: { ...this.state.modalSelections }
                    };
                    
                    this.state.cart.push(cartItem);
                    this.showToast('Produto adicionado ao carrinho!', 'success');
                }
                
                this.updateCartDisplay();
                // Atualizar o carrinho se estiver aberto
                if (this.state.isCartOpen) {
                    this.renderCartItems();
                }
                this.closeProductModal();
            }

            // Edit cart item
            editCartItem(itemId) {
                const cartItem = this.state.cart.find(item => item.id === itemId);
                if (!cartItem) return;
                
                // Find the original product
                const allItems = Object.values(this.menuData).flat();
                const originalProduct = allItems.find(item => item.id === cartItem.productId);
                if (!originalProduct) return;
                
                // Set current product and restore selections
                this.state.currentProduct = originalProduct;
                this.state.modalSelections = { ...cartItem.selections };
                this.state.editingCartItemId = itemId;
                
                const modal = document.getElementById('product-modal');
                if (!modal) return;
                
                const isMobile = window.innerWidth < 640;
                
                if (isMobile) {
                    this.showMobileModal(originalProduct);
                } else {
                    this.showDesktopModal(originalProduct);
                }
                
                modal.classList.remove('hidden');
                
                // Update the modal after it's rendered
                setTimeout(() => {
                    this.restoreModalSelections();
                    this.updatePriceSummary();
                }, 100);
            }

            restoreModalSelections() {
                if (!this.state.currentProduct || !this.state.modalSelections) return;
                
                // Restore quantity
                const quantityDisplay = document.getElementById('quantity-display');
                if (quantityDisplay) quantityDisplay.textContent = this.state.modalSelections.quantity;
                
                // Restore option selections
                Object.entries(this.state.modalSelections).forEach(([key, value]) => {
                    if (key === 'quantity') return;
                    
                    if (Array.isArray(value)) {
                        // Checkbox options
                        value.forEach(selectedValue => {
                            const input = document.querySelector(`input[data-option-key="${key}"][value="${selectedValue}"]`);
                            if (input) {
                                input.checked = true;
                                const optionItem = input.closest('.option-item');
                                if (optionItem) optionItem.classList.add('selected');
                            }
                        });
                    } else {
                        // Radio options
                        const input = document.querySelector(`input[data-option-key="${key}"][value="${value}"]`);
                        if (input) {
                            input.checked = true;
                            const optionItem = input.closest('.option-item');
                            if (optionItem) optionItem.classList.add('selected');
                        }
                    }
                });
            }

            // Restaurant Modal
            openRestaurantModal() {
                const modal = document.getElementById('restaurant-modal');
                if (!modal) return;
                
                const isMobile = window.innerWidth < 640;
                
                if (isMobile) {
                    this.showMobileRestaurantModal();
                } else {
                    this.showDesktopRestaurantModal();
                }
                
                modal.classList.remove('hidden');
            }

            showMobileRestaurantModal() {
                const mobileModal = document.getElementById('restaurant-modal-mobile');
                const desktopModal = document.getElementById('restaurant-modal-desktop');
                const modalContent = document.getElementById('restaurant-content-mobile');
                
                if (mobileModal) mobileModal.classList.remove('hidden');
                if (desktopModal) desktopModal.classList.add('hidden');
                if (modalContent) modalContent.innerHTML = this.generateMobileRestaurantContent();
                
                setTimeout(() => {
                    const mobileContent = document.getElementById('restaurant-modal-content-mobile');
                    if (mobileContent) mobileContent.classList.remove('translate-y-full');
                }, 10);
            }

            showDesktopRestaurantModal() {
                const mobileModal = document.getElementById('restaurant-modal-mobile');
                const desktopModal = document.getElementById('restaurant-modal-desktop');
                const modalContent = document.getElementById('restaurant-content-desktop');
                
                if (mobileModal) mobileModal.classList.add('hidden');
                if (desktopModal) desktopModal.classList.remove('hidden');
                if (modalContent) modalContent.innerHTML = this.generateDesktopRestaurantContent();
            }

            generateMobileRestaurantContent() {
                const data = this.restaurantData;
                const starsHtml = this.generateStarsRating(data.rating);
                
                return `
                    <div class="flex items-center justify-between px-4 py-3 border-b border-slate-200 bg-white rounded-t-2xl">
                        <div class="flex items-center space-x-2">
                            <h2 class="text-base font-semibold text-slate-900">Sobre o restaurante</h2>
                            <span class="text-slate-300">‚Ä¢</span>
                            <div class="flex items-center space-x-1.5">
                                <a href="#" class="text-slate-400 hover:text-pink-500 transition-colors p-1 hover:bg-pink-50 rounded">
                                    <i class="fab fa-instagram text-sm"></i>
                                </a>
                                <a href="#" class="text-slate-400 hover:text-blue-600 transition-colors p-1 hover:bg-blue-50 rounded">
                                    <i class="fab fa-facebook text-sm"></i>
                                </a>
                                <a href="#" class="text-slate-400 hover:text-green-600 transition-colors p-1 hover:bg-green-50 rounded">
                                    <i class="fab fa-whatsapp text-sm"></i>
                                </a>
                            </div>
                        </div>
                        <button class="text-slate-400 hover:text-slate-600 transition-colors p-1 hover:bg-slate-100 rounded-lg" onclick="app.closeRestaurantModal()">
                            <i class="fas fa-times text-base"></i>
                        </button>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto">
                        <div class="px-4 py-4 space-y-5">
                            <div class="text-center">
                                <div class="w-20 h-20 bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-lg">
                                    <i class="fas fa-utensils text-white text-2xl"></i>
                                </div>
                                <h1 class="text-lg font-bold text-slate-900 mb-1">${data.name}</h1>
                                <div class="flex items-center justify-center space-x-2 mb-2">
                                    ${starsHtml}
                                    <span class="text-xs font-semibold text-slate-900">${data.rating}</span>
                                    <span class="text-xs text-slate-500">‚Ä¢ ${data.reviewCount} avalia√ß√µes</span>
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-sm font-semibold text-slate-900 mb-2">Sobre n√≥s</h3>
                                <p class="text-xs text-slate-600 leading-relaxed">${data.description}</p>
                            </div>
                            
                            <div>
                                <h3 class="text-sm font-semibold text-slate-900 mb-3">Nosso estabelecimento</h3>
                                <div class="flex space-x-3 overflow-x-auto pb-2 -mx-4 px-4">
                                    ${data.photos.map(photo => `
                                        <div class="flex-shrink-0 w-24 h-20 bg-gradient-to-br from-slate-100 to-slate-200 rounded-lg flex flex-col items-center justify-center border border-slate-200">
                                            <span class="text-2xl mb-1">${photo.emoji}</span>
                                            <span class="text-xs text-slate-600 text-center px-1 leading-tight">${photo.description}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-sm font-semibold text-slate-900 mb-3">Hor√°rio de funcionamento</h3>
                                <div class="space-y-2">
                                    ${this.generateOperatingHours()}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            generateDesktopRestaurantContent() {
                const data = this.restaurantData;
                const starsHtml = this.generateStarsRating(data.rating);
                
                return `
                    <div class="flex items-center justify-between p-6 border-b border-slate-200">
                        <div class="flex items-center space-x-3">
                            <h2 class="text-xl font-semibold text-slate-900">Sobre o restaurante</h2>
                            <span class="text-slate-300">‚Ä¢</span>
                            <div class="flex items-center space-x-2">
                                <a href="#" class="text-slate-400 hover:text-pink-500 transition-colors p-1.5 hover:bg-pink-50 rounded-lg">
                                    <i class="fab fa-instagram text-base"></i>
                                </a>
                                <a href="#" class="text-slate-400 hover:text-blue-600 transition-colors p-1.5 hover:bg-blue-50 rounded-lg">
                                    <i class="fab fa-facebook text-base"></i>
                                </a>
                                <a href="#" class="text-slate-400 hover:text-green-600 transition-colors p-1.5 hover:bg-green-50 rounded-lg">
                                    <i class="fab fa-whatsapp text-base"></i>
                                </a>
                            </div>
                        </div>
                        <button class="text-slate-400 hover:text-slate-600 transition-colors p-2 hover:bg-slate-100 rounded-lg" onclick="app.closeRestaurantModal()">
                            <i class="fas fa-times text-base"></i>
                        </button>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto p-6 custom-scrollbar">
                        <div class="text-center mb-8">
                            <div class="w-24 h-24 bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg">
                                <i class="fas fa-utensils text-white text-3xl"></i>
                            </div>
                            <h1 class="text-2xl font-bold text-slate-900 mb-2">${data.name}</h1>
                            <div class="flex items-center justify-center space-x-2 mb-3">
                                ${starsHtml}
                                <span class="text-sm font-semibold text-slate-900">${data.rating}</span>
                                <span class="text-sm text-slate-500">‚Ä¢ ${data.reviewCount} avalia√ß√µes</span>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="text-base font-semibold text-slate-900 mb-3">Sobre n√≥s</h3>
                            <p class="text-sm text-slate-600 leading-relaxed">${data.description}</p>
                        </div>
                        
                        <div>
                            <h3 class="text-base font-semibold text-slate-900 mb-4">Nosso estabelecimento</h3>
                            <div class="flex space-x-4 overflow-x-auto pb-3">
                                ${data.photos.map(photo => `
                                    <div class="flex-shrink-0 w-32 h-24 bg-gradient-to-br from-slate-100 to-slate-200 rounded-xl flex flex-col items-center justify-center border border-slate-200 shadow-sm">
                                        <span class="text-3xl mb-1">${photo.emoji}</span>
                                        <span class="text-xs text-slate-600 text-center px-2 leading-tight">${photo.description}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="text-base font-semibold text-slate-900 mb-4">Hor√°rio de funcionamento</h3>
                            <div class="grid grid-cols-1 gap-2">
                                ${this.generateOperatingHours()}
                            </div>
                        </div>
                    </div>
                `;
            }

            generateStarsRating(rating) {
                const fullStars = Math.floor(rating);
                const hasHalfStar = rating % 1 >= 0.5;
                const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
                
                let starsHtml = '';
                
                for (let i = 0; i < fullStars; i++) {
                    starsHtml += '<i class="fas fa-star text-yellow-400 text-xs"></i>';
                }
                
                if (hasHalfStar) {
                    starsHtml += '<i class="fas fa-star-half-alt text-yellow-400 text-xs"></i>';
                }
                
                for (let i = 0; i < emptyStars; i++) {
                    starsHtml += '<i class="far fa-star text-slate-300 text-xs"></i>';
                }
                
                return starsHtml;
            }

            generateOperatingHours() {
                const days = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
                const dayNames = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'];
                
                const today = new Date().getDay();
                const tomorrow = (today + 1) % 7;
                
                // Reorder days starting with today, then tomorrow, then the rest
                const orderedDays = [];
                const orderedNames = [];
                
                // Add today
                orderedDays.push(days[today]);
                orderedNames.push('Hoje');
                
                // Add tomorrow
                orderedDays.push(days[tomorrow]);
                orderedNames.push('Amanh√£');
                
                // Add remaining days
                for (let i = 2; i < 7; i++) {
                    const dayIndex = (today + i) % 7;
                    orderedDays.push(days[dayIndex]);
                    orderedNames.push(dayNames[dayIndex]);
                }
                
                return orderedDays.map((day, index) => {
                    const dayData = this.restaurantData.hours[day];
                    const dayName = orderedNames[index];
                    const isToday = index === 0;
                    
                    if (dayData.closed) {
                        return `
                            <div class="flex items-center justify-between py-2 px-3 rounded-lg ${isToday ? 'bg-orange-50 border border-orange-200' : 'bg-slate-50'}">
                                <span class="text-xs font-medium ${isToday ? 'text-orange-900' : 'text-slate-900'}">${dayName}</span>
                                <span class="text-xs text-red-600 font-medium">Fechado</span>
                            </div>
                        `;
                    }
                    
                    return `
                        <div class="flex items-center justify-between py-2 px-3 rounded-lg ${isToday ? 'bg-orange-50 border border-orange-200' : 'bg-slate-50'}">
                            <span class="text-xs font-medium ${isToday ? 'text-orange-900' : 'text-slate-900'}">${dayName}</span>
                            <span class="text-xs ${isToday ? 'text-orange-700 font-semibold' : 'text-slate-600'}">${dayData.open} - ${dayData.close}</span>
                        </div>
                    `;
                }).join('');
            }

            closeRestaurantModal() {
                const modal = document.getElementById('restaurant-modal');
                if (!modal) return;
                
                const isMobile = window.innerWidth < 640;
                
                if (isMobile) {
                    const mobileContent = document.getElementById('restaurant-modal-content-mobile');
                    if (mobileContent) mobileContent.classList.add('translate-y-full');
                    setTimeout(() => modal.classList.add('hidden'), 300);
                } else {
                    modal.classList.add('hidden');
                }
            }

            // Carrinho
            toggleCart() {
                this.state.isCartOpen = !this.state.isCartOpen;
                
                const isMobile = window.innerWidth < 640;
                
                if (isMobile) {
                    const cartModal = document.getElementById('cart-modal-mobile');
                    const cartContent = document.getElementById('cart-content-mobile');
                    
                    if (this.state.isCartOpen) {
                        if (cartModal) cartModal.classList.remove('hidden');
                        setTimeout(() => {
                            if (cartContent) cartContent.classList.remove('translate-y-full');
                        }, 10);
                    } else {
                        if (cartContent) cartContent.classList.add('translate-y-full');
                        setTimeout(() => {
                            if (cartModal) cartModal.classList.add('hidden');
                        }, 300);
                    }
                } else {
                    const cartSidebar = document.getElementById('cart-sidebar-desktop');
                    if (cartSidebar) {
                        if (this.state.isCartOpen) {
                            cartSidebar.classList.remove('translate-x-full');
                        } else {
                            cartSidebar.classList.add('translate-x-full');
                        }
                    }
                }
                
                if (this.state.isCartOpen) this.renderCartItems();
            }

            updateCartDisplay() {
                const cartCountMobile = document.getElementById('cart-count-mobile');
                const cartCountDesktop = document.getElementById('cart-count-desktop');
                const cartTotalMobile = document.getElementById('cart-total-mobile');
                const cartTotalDesktop = document.getElementById('cart-total-desktop');
                
                const itemCount = this.state.cart.reduce((sum, item) => sum + item.quantity, 0);
                const totalPrice = this.state.cart.reduce((sum, item) => sum + item.totalPrice, 0);
                
                if (itemCount > 0) {
                    if (cartCountMobile) {
                        cartCountMobile.textContent = itemCount;
                        cartCountMobile.classList.remove('hidden');
                    }
                    if (cartCountDesktop) {
                        cartCountDesktop.textContent = itemCount;
                        cartCountDesktop.classList.remove('hidden');
                    }
                } else {
                    if (cartCountMobile) cartCountMobile.classList.add('hidden');
                    if (cartCountDesktop) cartCountDesktop.classList.add('hidden');
                }
                
                if (cartTotalMobile) cartTotalMobile.textContent = `R$ ${this.formatPrice(totalPrice)}`;
                if (cartTotalDesktop) cartTotalDesktop.textContent = `R$ ${this.formatPrice(totalPrice)}`;
            }

            renderCartItems() {
                const cartItemsMobile = document.getElementById('cart-items-mobile');
                const cartItemsDesktop = document.getElementById('cart-items-desktop');
                const emptyCartMobile = document.getElementById('empty-cart-mobile');
                const emptyCartDesktop = document.getElementById('empty-cart-desktop');
                
                if (this.state.cart.length === 0) {
                    if (cartItemsMobile) cartItemsMobile.innerHTML = '';
                    if (cartItemsDesktop) cartItemsDesktop.innerHTML = '';
                    if (emptyCartMobile) emptyCartMobile.classList.remove('hidden');
                    if (emptyCartDesktop) emptyCartDesktop.classList.remove('hidden');
                } else {
                    if (emptyCartMobile) emptyCartMobile.classList.add('hidden');
                    if (emptyCartDesktop) emptyCartDesktop.classList.add('hidden');
                    
                    const cartItemsHtml = this.state.cart.map(item => this.createCartItemElement(item)).join('');
                    
                    if (cartItemsMobile) cartItemsMobile.innerHTML = cartItemsHtml;
                    if (cartItemsDesktop) cartItemsDesktop.innerHTML = cartItemsHtml;
                }
            }

            createCartItemElement(item) {
                const optionsText = item.options && item.options.length > 0 
                    ? `<div class="text-xs text-slate-500 mt-1 leading-relaxed break-words">${item.options.join(', ')}</div>` 
                    : '';
                
                return `
                    <div class="relative p-3 bg-slate-50 rounded-lg border border-slate-100 cursor-pointer hover:bg-slate-100 transition-colors" onclick="app.editCartItem(${item.id})">
                        <div class="flex items-start space-x-3">
                            <div class="w-14 h-14 bg-gradient-to-br from-slate-100 to-slate-200 rounded-lg flex items-center justify-center flex-shrink-0">
                                <span class="text-2xl">${item.icon}</span>
                            </div>
                            <div class="flex-1 min-w-0 pr-20">
                                <div class="flex flex-wrap items-center gap-1.5 text-xs font-semibold text-slate-900 mb-1">
                                    <span>${item.quantity}</span>
                                    <span class="text-slate-300">‚Ä¢</span>
                                    <span class="break-words">${item.name}</span>
                                    <span class="text-slate-300">‚Ä¢</span>
                                    <span class="text-slate-600 font-medium whitespace-nowrap">R$ ${this.formatPrice(item.unitPrice)}</span>
                                </div>
                                ${optionsText}
                            </div>
                        </div>
                        
                        <!-- Bot√£o remover no canto superior direito -->
                        <button class="absolute top-2 right-2 flex items-center space-x-1 text-red-500 hover:text-red-700 transition-colors px-2 py-1 border border-red-200 hover:border-red-300 rounded-md hover:bg-red-50 z-10" onclick="event.stopPropagation(); app.removeFromCart(${item.id})">
                            <span class="text-xs font-medium">Remover</span>
                            <i class="fas fa-trash text-xs"></i>
                        </button>
                        
                        <!-- Valor total logo abaixo do bot√£o remover -->
                        <div class="absolute top-10 right-2 text-xs font-bold text-orange-600">
                            R$ ${this.formatPrice(item.totalPrice)}
                        </div>
                    </div>
                `;
            }

            removeFromCart(itemId) {
                this.state.cart = this.state.cart.filter(item => item.id !== itemId);
                this.updateCartDisplay();
                this.renderCartItems();
                this.showToast('Item removido do carrinho', 'info');
            }

            openCheckoutModal() {
                if (this.state.cart.length === 0) {
                    this.showToast('Seu carrinho est√° vazio', 'warning');
                    return;
                }
                
                this.showToast('Funcionalidade de checkout em desenvolvimento', 'info');
            }

            closeCheckoutModal() {
                // Placeholder for checkout modal close
            }

            // Toast notifications
            showToast(message, type = 'success') {
                const toast = document.getElementById('toast');
                const toastMessage = document.getElementById('toast-message');
                const toastIcon = document.getElementById('toast-icon');
                
                if (!toast || !toastMessage || !toastIcon) return;
                
                // Set message
                toastMessage.textContent = message;
                
                // Set icon and color based on type
                let iconClass = 'fas fa-check-circle';
                let bgColor = 'bg-emerald-500';
                
                switch (type) {
                    case 'warning':
                        iconClass = 'fas fa-exclamation-triangle';
                        bgColor = 'bg-yellow-500';
                        break;
                    case 'error':
                        iconClass = 'fas fa-times-circle';
                        bgColor = 'bg-red-500';
                        break;
                    case 'info':
                        iconClass = 'fas fa-info-circle';
                        bgColor = 'bg-blue-500';
                        break;
                }
                
                toastIcon.className = `${iconClass} text-sm`;
                toast.className = `fixed bottom-6 left-1/2 transform -translate-x-1/2 translate-y-[calc(100%+2rem)] ${bgColor} text-white px-4 py-2.5 rounded-lg shadow-2xl transition-all duration-300 z-50 whitespace-nowrap`;
                
                // Show toast
                setTimeout(() => {
                    toast.classList.remove('translate-y-[calc(100%+2rem)]');
                    toast.classList.add('translate-y-0');
                }, 100);
                
                // Hide toast after 3 seconds
                setTimeout(() => {
                    toast.classList.remove('translate-y-0');
                    toast.classList.add('translate-y-[calc(100%+2rem)]');
                }, 3000);
            }
        }

        // Initialize the app
        const app = new MenuApp();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97607a11d01a210d',t:'MTc1NjM0OTE3MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MenuFlow - Card√°pio Digital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .category-scroll {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .category-scroll::-webkit-scrollbar {
            display: none;
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-up {
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Cover Photo -->
    <div class="relative h-48 sm:h-64 bg-gradient-to-r from-orange-400 via-red-500 to-pink-500 overflow-hidden">
        <div class="absolute inset-0 bg-black bg-opacity-30"></div>
        <div class="absolute inset-0 flex items-center justify-center">
            <div class="text-center text-white">
                <div class="text-6xl mb-2">üçΩÔ∏è</div>
                <h1 class="text-2xl sm:text-3xl font-bold mb-1">Restaurante Sabor</h1>
                <p class="text-sm sm:text-base opacity-90">Sabores √∫nicos, experi√™ncias inesquec√≠veis</p>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <div class="bg-gradient-to-r from-green-50 to-green-100 border-b border-green-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-center py-2">
                <div class="flex items-center space-x-2">
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    <span class="text-sm text-green-700 font-medium">üïê Aberto agora - Pedidos at√© 23h</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Header - Mobile Only -->
    <header class="lg:hidden bg-white shadow-sm sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <button onclick="openRestaurantProfile()" class="flex items-center space-x-2.5 hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors">
                    <div class="w-10 h-10 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-utensils text-white text-base"></i>
                    </div>
                    <div class="text-left flex-1">
                        <h1 class="text-lg font-bold text-gray-900">Restaurante Sabor</h1>
                        <p class="text-xs text-gray-500">Delivery ‚Ä¢ Local ‚Ä¢ Retirada</p>
                    </div>
                    <i class="fas fa-chevron-right text-gray-400"></i>
                </button>
                
                <!-- Mobile Cart Button -->
                <button onclick="toggleCart()" class="relative bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors">
                    <i class="fas fa-shopping-cart mr-2"></i>
                    Carrinho
                    <span id="cart-count-mobile" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Mobile Search Bar -->
    <div class="lg:hidden bg-white border-b px-4 py-3 sticky top-16 z-30">
        <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-search text-gray-400"></i>
            </div>
            <input 
                type="text" 
                id="search-input-mobile"
                placeholder="Buscar produto..." 
                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                oninput="searchProducts()"
            >
        </div>
    </div>

    <!-- Mobile Categories -->
    <div class="lg:hidden bg-white border-b sticky top-[7.5rem] z-30">
        <div class="px-4 py-3">
            <div class="flex space-x-2 overflow-x-auto category-scroll">
                <button onclick="filterCategory('all')" class="category-btn-mobile active flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium transition-colors bg-orange-500 text-white">
                    <i class="fas fa-th-large mr-2"></i>
                    Todos
                </button>
                <button onclick="filterCategory('burgers')" class="category-btn-mobile flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium transition-colors text-gray-600 bg-gray-100 hover:bg-orange-100 hover:text-orange-600">
                    <span class="mr-2">üçî</span>
                    Hamb√∫rguers
                </button>
                <button onclick="filterCategory('pizzas')" class="category-btn-mobile flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium transition-colors text-gray-600 bg-gray-100 hover:bg-orange-100 hover:text-orange-600">
                    <span class="mr-2">üçï</span>
                    Pizzas
                </button>
                <button onclick="filterCategory('drinks')" class="category-btn-mobile flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium transition-colors text-gray-600 bg-gray-100 hover:bg-orange-100 hover:text-orange-600">
                    <span class="mr-2">ü•§</span>
                    Bebidas
                </button>
                <button onclick="filterCategory('desserts')" class="category-btn-mobile flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium transition-colors text-gray-600 bg-gray-100 hover:bg-orange-100 hover:text-orange-600">
                    <span class="mr-2">üç∞</span>
                    Sobremesas
                </button>
            </div>
        </div>
    </div>

    <!-- Mobile Main Content -->
    <main class="lg:hidden px-4 py-6">
        <div class="grid grid-cols-1 gap-6" id="menu-items-mobile">
            <!-- Menu items will be populated by JavaScript -->
        </div>
    </main>

    <!-- Desktop Layout with Sidebar -->
    <div class="hidden lg:flex">
        <!-- Desktop Sidebar -->
        <aside class="w-80 bg-white border-r sticky top-0 h-screen overflow-y-auto">
            <div class="p-6 space-y-6">
                <!-- Restaurant Profile -->
                <button onclick="openRestaurantProfile()" class="flex items-center space-x-2.5 p-2.5 rounded-lg hover:bg-gray-50 transition-colors w-full text-left">
                    <div class="w-10 h-10 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-utensils text-white text-base"></i>
                    </div>
                    <div class="text-left flex-1">
                        <h1 class="text-base font-bold text-gray-900">Restaurante Sabor</h1>
                        <p class="text-xs text-gray-500">Delivery ‚Ä¢ Local ‚Ä¢ Retirada</p>
                    </div>
                    <i class="fas fa-chevron-right text-gray-400"></i>
                </button>
                
                <!-- Search Bar -->
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-search text-gray-400"></i>
                    </div>
                    <input 
                        type="text" 
                        id="search-input-desktop"
                        placeholder="Buscar produto..." 
                        class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        oninput="searchProducts()"
                    >
                </div>
                
                <!-- Categories -->
                <div>
                    <h2 class="text-lg font-semibold text-gray-900 mb-4">Categorias</h2>
                    <nav class="space-y-2">
                        <button onclick="filterCategory('all')" class="category-btn-sidebar active w-full text-left px-4 py-3 rounded-lg transition-colors bg-orange-500 text-white">
                            <i class="fas fa-th-large mr-3"></i>
                            Todos os Produtos
                        </button>
                        <button onclick="filterCategory('burgers')" class="category-btn-sidebar w-full text-left px-4 py-3 rounded-lg transition-colors text-gray-600 hover:bg-gray-50 hover:text-orange-500">
                            <span class="mr-3">üçî</span>
                            Hamb√∫rguers
                        </button>
                        <button onclick="filterCategory('pizzas')" class="category-btn-sidebar w-full text-left px-4 py-3 rounded-lg transition-colors text-gray-600 hover:bg-gray-50 hover:text-orange-500">
                            <span class="mr-3">üçï</span>
                            Pizzas
                        </button>
                        <button onclick="filterCategory('drinks')" class="category-btn-sidebar w-full text-left px-4 py-3 rounded-lg transition-colors text-gray-600 hover:bg-gray-50 hover:text-orange-500">
                            <span class="mr-3">ü•§</span>
                            Bebidas
                        </button>
                        <button onclick="filterCategory('desserts')" class="category-btn-sidebar w-full text-left px-4 py-3 rounded-lg transition-colors text-gray-600 hover:bg-gray-50 hover:text-orange-500">
                            <span class="mr-3">üç∞</span>
                            Sobremesas
                        </button>
                    </nav>
                </div>
                
                <!-- Cart Button -->
                <button onclick="toggleCart()" class="w-full relative bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 transition-colors">
                    <i class="fas fa-shopping-cart mr-2"></i>
                    Carrinho
                    <span id="cart-count-desktop" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                </button>
            </div>
        </aside>
        
        <!-- Desktop Main Content -->
        <main class="flex-1 px-8 py-8">
            <div class="grid grid-cols-1 xl:grid-cols-2 2xl:grid-cols-3 gap-6" id="menu-items-desktop">
                <!-- Menu items will be populated by JavaScript -->
            </div>
        </main>
    </div>

    <!-- Cart Sidebar - Desktop -->
    <div id="cart-sidebar-desktop" class="hidden sm:block fixed inset-y-0 right-0 w-96 bg-white shadow-xl transform translate-x-full transition-transform duration-300 z-50">
        <div class="flex flex-col h-full">
            <div class="flex items-center justify-between p-6 border-b">
                <h2 class="text-xl font-semibold">Seu Pedido</h2>
                <button onclick="toggleCart()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="flex-1 overflow-y-auto p-6">
                <div id="cart-items-desktop" class="space-y-4">
                    <!-- Cart items will be populated by JavaScript -->
                </div>
                
                <div id="empty-cart-desktop" class="text-center py-12">
                    <i class="fas fa-shopping-cart text-gray-300 text-4xl mb-4"></i>
                    <p class="text-gray-500">Seu carrinho est√° vazio</p>
                </div>
            </div>
            
            <div class="border-t p-6 space-y-4">
                <div class="flex justify-between text-lg font-semibold">
                    <span>Total:</span>
                    <span id="cart-total-desktop" class="text-orange-600">R$ 0,00</span>
                </div>
                <button onclick="checkout()" class="w-full bg-orange-500 text-white py-3 rounded-lg hover:bg-orange-600 transition-colors font-medium">
                    <i class="fas fa-credit-card mr-2"></i>Finalizar Pedido
                </button>
            </div>
        </div>
    </div>

    <!-- Cart Modal - Mobile -->
    <div id="cart-modal-mobile" class="sm:hidden fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50" onclick="toggleCart()"></div>
        <div id="cart-content-mobile" class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-xl transform translate-y-full transition-transform duration-300 max-h-[80vh] flex flex-col">
            <div class="flex items-center justify-between p-4 border-b bg-white rounded-t-2xl">
                <h2 class="text-lg font-semibold">Seu Pedido</h2>
                <button onclick="toggleCart()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="flex-1 overflow-y-auto p-4 min-h-0">
                <div id="cart-items-mobile" class="space-y-3">
                    <!-- Cart items will be populated by JavaScript -->
                </div>
                
                <div id="empty-cart-mobile" class="text-center py-8">
                    <i class="fas fa-shopping-cart text-gray-300 text-3xl mb-3"></i>
                    <p class="text-gray-500">Seu carrinho est√° vazio</p>
                </div>
            </div>
            
            <div class="border-t p-4 space-y-3 bg-white">
                <div class="flex justify-between text-lg font-semibold">
                    <span>Total:</span>
                    <span id="cart-total-mobile" class="text-orange-600">R$ 0,00</span>
                </div>
                <button onclick="checkout()" class="w-full bg-orange-500 text-white py-3 rounded-lg hover:bg-orange-600 transition-colors font-medium">
                    <i class="fas fa-credit-card mr-2"></i>Finalizar Pedido
                </button>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-3 md:p-6 lg:p-8 z-50 hidden">
        <div class="bg-white rounded-2xl w-full max-w-lg md:max-w-4xl lg:max-w-6xl xl:max-w-7xl slide-up shadow-2xl max-h-[95vh] md:max-h-[90vh]">
            <div id="modal-content">
                <!-- Modal content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkout-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-3 md:p-6 lg:p-8 z-50 hidden">
        <div class="bg-white rounded-2xl w-full max-w-lg md:max-w-5xl lg:max-w-6xl xl:max-w-7xl slide-up shadow-2xl max-h-[95vh] md:max-h-[90vh] flex flex-col">
            <!-- Header -->
            <div class="flex items-center justify-between p-4 md:p-6 border-b flex-shrink-0">
                <h2 class="text-lg md:text-xl font-bold text-gray-900">Finalizar Pedido</h2>
                <button onclick="closeCheckoutModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <div class="flex-1 overflow-y-auto min-h-0">
                <form id="checkout-form" class="p-4 md:p-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8">
                        <!-- Left Column -->
                        <div class="space-y-6">
                            <!-- Customer Data -->
                            <div>
                                <h3 class="text-base font-semibold text-gray-900 mb-4">Seus Dados</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome completo</label>
                                        <input type="text" id="customer-name" required 
                                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                                               placeholder="Digite seu nome completo">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Telefone</label>
                                        <input type="tel" id="customer-phone" required 
                                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                                               placeholder="(63) 98129-3361"
                                               oninput="formatPhone(this)">
                                    </div>
                                </div>
                            </div>

                            <!-- Order Mode -->
                            <div>
                                <h3 class="text-base font-semibold text-gray-900 mb-4">Como voc√™ quer receber?</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                                        <input type="radio" name="order-mode" value="delivery" class="text-orange-500 focus:ring-orange-500" required onchange="toggleDeliveryFields()">
                                        <div class="ml-3">
                                            <div class="text-sm font-medium">Entrega ‚Ä¢ <span class="text-gray-500 font-normal">Receba em casa</span></div>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                                        <input type="radio" name="order-mode" value="pickup" class="text-orange-500 focus:ring-orange-500" required onchange="toggleDeliveryFields()">
                                        <div class="ml-3">
                                            <div class="text-sm font-medium">Retirada ‚Ä¢ <span class="text-gray-500 font-normal">Buscar no local</span></div>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                                        <input type="radio" name="order-mode" value="dine-in" class="text-orange-500 focus:ring-orange-500" required onchange="toggleDeliveryFields()">
                                        <div class="ml-3">
                                            <div class="text-sm font-medium">No Local ‚Ä¢ <span class="text-gray-500 font-normal">Consumir aqui</span></div>
                                        </div>
                                    </label>
                                </div>
                                
                                <!-- Delivery Address Fields -->
                                <div id="delivery-fields" class="mt-4 space-y-4 hidden">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">CEP da entrega</label>
                                        <input type="text" id="delivery-cep" 
                                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                                               placeholder="00000-000"
                                               oninput="formatCEP(this)">
                                    </div>
                                </div>
                            </div>

                            <!-- Payment Method -->
                            <div>
                                <h3 class="text-base font-semibold text-gray-900 mb-4">Como voc√™ vai pagar?</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                                        <input type="radio" name="payment-method" value="pix" class="text-orange-500 focus:ring-orange-500" required onchange="togglePaymentFields()">
                                        <div class="ml-3">
                                            <div class="text-sm font-medium">PIX ‚Ä¢ <span class="text-gray-500 font-normal">Instant√¢neo e seguro</span></div>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                                        <input type="radio" name="payment-method" value="card-online" class="text-orange-500 focus:ring-orange-500" required onchange="togglePaymentFields()">
                                        <div class="ml-3">
                                            <div class="text-sm font-medium">Cart√£o Online ‚Ä¢ <span class="text-gray-500 font-normal">Seguro pela internet</span></div>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                                        <input type="radio" name="payment-method" value="cash" class="text-orange-500 focus:ring-orange-500" required onchange="togglePaymentFields()">
                                        <div class="ml-3">
                                            <div class="text-sm font-medium">Dinheiro ‚Ä¢ <span class="text-gray-500 font-normal">Na entrega/retirada</span></div>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                                        <input type="radio" name="payment-method" value="card-machine" class="text-orange-500 focus:ring-orange-500" required onchange="togglePaymentFields()">
                                        <div class="ml-3">
                                            <div class="text-sm font-medium">Maquininha ‚Ä¢ <span class="text-gray-500 font-normal">D√©bito ou cr√©dito</span></div>
                                        </div>
                                    </label>
                                </div>
                                
                                <!-- Payment Specific Fields -->
                                <div id="payment-fields" class="mt-4 space-y-4">
                                    <!-- PIX Fields -->
                                    <div id="pix-fields" class="hidden">
                                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                            <h4 class="text-sm font-medium text-blue-900 mb-3">Pagamento via PIX</h4>
                                            <div class="text-center">
                                                <div id="pix-qr-code" class="w-48 h-48 mx-auto bg-white border-2 border-blue-300 rounded-lg flex items-center justify-center mb-3">
                                                    <span class="text-gray-400">QR Code ser√° gerado</span>
                                                </div>
                                                <div class="space-y-2">
                                                    <p class="text-xs text-blue-700">Chave PIX (Copia e Cola):</p>
                                                    <div class="flex items-center space-x-2">
                                                        <input type="text" id="pix-key" readonly 
                                                               class="flex-1 px-3 py-2 bg-gray-50 border border-gray-300 rounded text-xs font-mono"
                                                               value="00020126580014BR.GOV.BCB.PIX013663981293361520400005303986540525.905802BR5925RESTAURANTE SABOR LTDA6009PALMAS6304">
                                                        <button onclick="copyPixKey()" class="px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors text-xs">
                                                            <i class="fas fa-copy"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Card Online Fields -->
                                    <div id="card-online-fields" class="hidden">
                                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                            <h4 class="text-sm font-medium text-green-900 mb-3">Dados do Cart√£o</h4>
                                            <div class="space-y-3">
                                                <div>
                                                    <label class="block text-xs font-medium text-gray-700 mb-1">N√∫mero do cart√£o</label>
                                                    <input type="text" id="card-number" 
                                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                                                           placeholder="0000 0000 0000 0000"
                                                           oninput="formatCardNumber(this)">
                                                </div>
                                                <div class="grid grid-cols-2 gap-3">
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700 mb-1">Validade</label>
                                                        <input type="text" id="card-expiry" 
                                                               class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                                                               placeholder="MM/AA"
                                                               oninput="formatCardExpiry(this)">
                                                    </div>
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700 mb-1">CVV</label>
                                                        <input type="text" id="card-cvv" 
                                                               class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                                                               placeholder="000"
                                                               maxlength="4">
                                                    </div>
                                                </div>
                                                <div>
                                                    <label class="block text-xs font-medium text-gray-700 mb-1">Nome no cart√£o</label>
                                                    <input type="text" id="card-name" 
                                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                                                           placeholder="Nome como est√° no cart√£o">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Cash Fields -->
                                    <div id="cash-fields" class="hidden">
                                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                            <h4 class="text-sm font-medium text-yellow-900 mb-3">Pagamento em Dinheiro</h4>
                                            <div class="space-y-3">
                                                <label class="flex items-center">
                                                    <input type="checkbox" id="needs-change" class="text-orange-500 focus:ring-orange-500" onchange="toggleChangeField()">
                                                    <span class="ml-2 text-sm text-gray-700">Preciso de troco</span>
                                                </label>
                                                <div id="change-field" class="hidden">
                                                    <label class="block text-xs font-medium text-gray-700 mb-1">Valor que voc√™ tem</label>
                                                    <input type="text" id="cash-amount" 
                                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                                                           placeholder="R$ 0,00"
                                                           oninput="formatCurrency(this); calculateChange()">
                                                    <div id="change-amount" class="mt-2 text-sm text-gray-600"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Card Machine Fields -->
                                    <div id="card-machine-fields" class="hidden">
                                        <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                            <h4 class="text-sm font-medium text-purple-900 mb-3">Tipo de Cart√£o</h4>
                                            <div class="space-y-2">
                                                <label class="flex items-center p-2 border border-purple-200 rounded cursor-pointer hover:bg-purple-100">
                                                    <input type="radio" name="card-type" value="debit" class="text-purple-500 focus:ring-purple-500">
                                                    <span class="ml-2 text-sm text-gray-700">Cart√£o de D√©bito</span>
                                                </label>
                                                <label class="flex items-center p-2 border border-purple-200 rounded cursor-pointer hover:bg-purple-100">
                                                    <input type="radio" name="card-type" value="credit" class="text-purple-500 focus:ring-purple-500">
                                                    <span class="ml-2 text-sm text-gray-700">Cart√£o de Cr√©dito</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Observations -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Observa√ß√µes</label>
                                <textarea id="checkout-observations" 
                                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none" 
                                          rows="3" 
                                          placeholder="Alguma observa√ß√£o especial para o seu pedido? (opcional)"></textarea>
                            </div>
                        </div>

                        <!-- Right Column -->
                        <div class="space-y-6">
                            <!-- Order Summary -->
                            <div>
                                <h3 class="text-base font-semibold text-gray-900 mb-4">Resumo do Pedido</h3>
                                <div class="bg-gray-50 rounded-lg p-4 lg:sticky lg:top-0">
                                    <div id="checkout-order-summary" class="space-y-3 mb-4 max-h-96 overflow-y-auto">
                                        <!-- Order items will be populated by JavaScript -->
                                    </div>
                                    <div class="border-t pt-4">
                                        <div class="flex justify-between items-center">
                                            <span class="text-base font-semibold">Total</span>
                                            <span id="checkout-total" class="text-base font-bold text-orange-600">R$ 0,00</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Footer -->
            <div class="border-t p-4 md:p-6 flex-shrink-0">
                <div class="flex gap-3">
                    <button onclick="closeCheckoutModal()" class="w-32 md:w-40 bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium">
                        <i class="fas fa-chevron-left mr-2"></i>Voltar
                    </button>
                    <button type="submit" form="checkout-form" class="flex-1 bg-orange-500 text-white py-3 rounded-lg hover:bg-orange-600 transition-colors font-medium">
                        <i class="fas fa-check mr-2"></i>Confirmar Pedido
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Restaurant Profile Modal -->
    <div id="restaurant-profile-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <!-- Close Button Outside Modal -->
        <button onclick="closeRestaurantProfile()" class="absolute top-4 right-4 text-white hover:text-gray-300 z-10">
            <i class="fas fa-times text-2xl"></i>
        </button>
        
        <div class="bg-white rounded-2xl w-full max-w-4xl slide-up shadow-2xl max-h-[80vh] flex flex-col">
            <!-- Fixed Header -->
            <div class="flex-shrink-0 bg-white rounded-t-2xl border-b border-gray-100 sticky top-0 z-10">
                <!-- Restaurant Header -->
                <div class="px-6 py-3">
                    <div class="flex items-center space-x-4">
                        <!-- Logo -->
                        <div class="flex-shrink-0">
                            <button onclick="openImageModal('logo')" class="block">
                                <div class="w-12 h-12 bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl flex items-center justify-center hover:shadow-lg transition-all duration-300 hover:scale-105">
                                    <i class="fas fa-utensils text-white text-sm"></i>
                                </div>
                            </button>
                        </div>
                        
                        <!-- Restaurant Info -->
                        <div class="flex-1 min-w-0">
                            <div class="flex items-center justify-between">
                                <!-- Name and Rating Column -->
                                <div class="flex-1 min-w-0 pr-4">
                                    <h1 class="text-lg font-bold text-gray-900 leading-tight mb-1">Restaurante Sabor</h1>
                                    
                                    <!-- Rating -->
                                    <div class="flex items-center space-x-2">
                                        <div class="flex items-center">
                                            <span class="text-sm font-bold text-gray-900 mr-2">4.8</span>
                                            <div class="flex text-yellow-400 mr-2">
                                                <i class="fas fa-star text-xs"></i>
                                                <i class="fas fa-star text-xs"></i>
                                                <i class="fas fa-star text-xs"></i>
                                                <i class="fas fa-star text-xs"></i>
                                                <i class="fas fa-star text-xs"></i>
                                            </div>
                                        </div>
                                        <span class="text-xs text-gray-500">(324 avalia√ß√µes)</span>
                                    </div>
                                </div>
                                
                                <!-- Social Media -->
                                <div class="flex items-center space-x-3 flex-shrink-0">
                                    <a href="https://instagram.com/restaurantesabor" target="_blank" class="w-10 h-10 bg-gray-100 hover:bg-pink-50 rounded-lg flex items-center justify-center text-gray-600 hover:text-pink-600 transition-all duration-300 hover:scale-110">
                                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                                        </svg>
                                    </a>
                                    <a href="https://facebook.com/restaurantesabor" target="_blank" class="w-10 h-10 bg-gray-100 hover:bg-blue-50 rounded-lg flex items-center justify-center text-gray-600 hover:text-blue-600 transition-all duration-300 hover:scale-110">
                                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                                        </svg>
                                    </a>
                                    <a href="https://wa.me/5563981293361" target="_blank" class="w-10 h-10 bg-gray-100 hover:bg-green-50 rounded-lg flex items-center justify-center text-gray-600 hover:text-green-600 transition-all duration-300 hover:scale-110">
                                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Divis√£o visual -->
                <div class="h-px bg-gray-200"></div>
            </div>

            <div class="flex-1 overflow-y-auto min-h-0">
                <div class="p-6">
                    
                    <!-- Description -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">Sobre o Restaurante</h3>
                        <p class="text-gray-600 leading-relaxed">
                            O Restaurante Sabor √© um estabelecimento familiar que h√° mais de 15 anos serve os melhores pratos da culin√°ria brasileira e internacional. 
                            Nosso compromisso √© oferecer ingredientes frescos, sabores √∫nicos e um atendimento excepcional. 
                            Trabalhamos com fornecedores locais e priorizamos a qualidade em cada prato que servimos.
                        </p>
                        <p class="text-gray-600 leading-relaxed mt-3">
                            Oferecemos delivery, retirada no local e consumo no restaurante. Nossa cozinha funciona todos os dias da semana, 
                            sempre com o mesmo padr√£o de excel√™ncia que nos tornou refer√™ncia na regi√£o.
                        </p>
                    </div>
                    
                    <!-- Photos -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Fotos do Estabelecimento</h3>
                        <div class="flex space-x-4 overflow-x-auto pb-4 category-scroll">
                            <button onclick="openImageModal(0)" class="flex-shrink-0 w-48 h-36 bg-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow">
                                <img src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800&h=600&fit=crop&crop=center" alt="Interior do restaurante" class="w-full h-full object-cover" onerror="this.src=''; this.alt='Imagem n√£o dispon√≠vel'; this.style.display='none'; this.parentElement.innerHTML='<div class=\'w-full h-full bg-gradient-to-br from-orange-100 to-orange-200 flex items-center justify-center\'><span class=\'text-4xl\'>üçΩÔ∏è</span></div>';">
                            </button>
                            
                            <button onclick="openImageModal(1)" class="flex-shrink-0 w-48 h-36 bg-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow">
                                <img src="https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=800&h=600&fit=crop&crop=center" alt="Ambiente do restaurante" class="w-full h-full object-cover" onerror="this.src=''; this.alt='Imagem n√£o dispon√≠vel'; this.style.display='none'; this.parentElement.innerHTML='<div class=\'w-full h-full bg-gradient-to-br from-orange-100 to-orange-200 flex items-center justify-center\'><span class=\'text-4xl\'>üè™</span></div>';">
                            </button>
                            
                            <button onclick="openImageModal(2)" class="flex-shrink-0 w-48 h-36 bg-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow">
                                <img src="https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=800&h=600&fit=crop&crop=center" alt="Mesa do restaurante" class="w-full h-full object-cover" onerror="this.src=''; this.alt='Imagem n√£o dispon√≠vel'; this.style.display='none'; this.parentElement.innerHTML='<div class=\'w-full h-full bg-gradient-to-br from-orange-100 to-orange-200 flex items-center justify-center\'><span class=\'text-4xl\'>üç¥</span></div>';">
                            </button>
                            
                            <button onclick="openImageModal(3)" class="flex-shrink-0 w-48 h-36 bg-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow">
                                <img src="https://images.unsplash.com/photo-1551218808-94e220e084d2?w=800&h=600&fit=crop&crop=center" alt="Cozinha do restaurante" class="w-full h-full object-cover" onerror="this.src=''; this.alt='Imagem n√£o dispon√≠vel'; this.style.display='none'; this.parentElement.innerHTML='<div class=\'w-full h-full bg-gradient-to-br from-orange-100 to-orange-200 flex items-center justify-center\'><span class=\'text-4xl\'>üë®‚Äçüç≥</span></div>';">
                            </button>
                            
                            <button onclick="openImageModal(4)" class="flex-shrink-0 w-48 h-36 bg-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow">
                                <img src="https://images.unsplash.com/photo-1559329007-40df8a9345d8?w=800&h=600&fit=crop&crop=center" alt="Fachada do restaurante" class="w-full h-full object-cover" onerror="this.src=''; this.alt='Imagem n√£o dispon√≠vel'; this.style.display='none'; this.parentElement.innerHTML='<div class=\'w-full h-full bg-gradient-to-br from-orange-100 to-orange-200 flex items-center justify-center\'><span class=\'text-4xl\'>üè¢</span></div>';">
                            </button>
                        </div>
                    </div>
                    
                    <!-- Hours -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">Hor√°rio de Funcionamento</h3>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Segunda a Quinta</span>
                                <span class="text-gray-900 font-medium">18:00 - 23:00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Sexta e S√°bado</span>
                                <span class="text-gray-900 font-medium">18:00 - 00:00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Domingo</span>
                                <span class="text-gray-900 font-medium">18:00 - 22:00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Image Modal -->
    <div id="image-modal" class="fixed inset-0 bg-black bg-opacity-95 flex items-center justify-center p-4 z-[9999] hidden">
        <div class="relative max-w-6xl max-h-full w-full h-full flex items-center justify-center">
            <!-- Close Button -->
            <button onclick="closeImageModal()" class="absolute top-4 right-4 text-white hover:text-gray-300 z-10 bg-black bg-opacity-50 rounded-full w-10 h-10 flex items-center justify-center">
                <i class="fas fa-times text-xl"></i>
            </button>
            
            <!-- Previous Button -->
            <button id="prev-image-btn" onclick="previousImage()" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300 z-10 bg-black bg-opacity-50 rounded-full w-12 h-12 flex items-center justify-center">
                <i class="fas fa-chevron-left text-xl"></i>
            </button>
            
            <!-- Next Button -->
            <button id="next-image-btn" onclick="nextImage()" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300 z-10 bg-black bg-opacity-50 rounded-full w-12 h-12 flex items-center justify-center">
                <i class="fas fa-chevron-right text-xl"></i>
            </button>
            
            <!-- Image Container -->
            <div id="image-container" class="relative w-full h-full flex items-center justify-center touch-pan-x">
                <img id="modal-image" src="" alt="" class="max-w-full max-h-full object-contain rounded-lg select-none">
            </div>
            
            <!-- Image Counter -->
            <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-4 py-2 rounded-full">
                <span id="image-counter">1 / 5</span>
            </div>
        </div>
    </div>

    <!-- Order Confirmation Modal -->
    <div id="order-confirmation-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-2xl w-full max-w-md slide-up shadow-2xl">
            <div class="p-6">
                <!-- Header -->
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-check text-green-600 text-2xl"></i>
                    </div>
                    <h2 class="text-xl font-bold text-gray-900 mb-2">Pedido Confirmado!</h2>
                    <p id="estimated-time" class="text-gray-500">Tempo estimado: 30-45 min</p>
                </div>
                
                <!-- Order Status -->
                <div class="mb-6">
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <div id="status-1" class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-utensils text-white text-xs"></i>
                            </div>
                            <div class="flex-1">
                                <div class="text-sm font-medium text-gray-900">Preparando</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center">
                            <div id="status-2" class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-motorcycle text-white text-xs"></i>
                            </div>
                            <div class="flex-1">
                                <div id="status-2-text" class="text-sm font-medium text-gray-500">Em rota</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center">
                            <div id="status-3" class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-check text-white text-xs"></i>
                            </div>
                            <div class="flex-1">
                                <div id="status-3-text" class="text-sm font-medium text-gray-500">Finalizado</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Thank you message -->
                <div class="text-center mb-6">
                    <p class="text-gray-500">Obrigado pela prefer√™ncia, volte sempre!</p>
                </div>
                
                <!-- Actions -->
                <div class="space-y-3">
                    <button onclick="openOrderTracking()" class="w-full bg-orange-500 text-white py-3 rounded-lg hover:bg-orange-600 transition-colors font-medium">
                        <i class="fas fa-eye mr-2"></i>Acompanhar Pedido
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Tracking Modal -->
    <div id="order-tracking-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-2xl w-full max-w-md slide-up shadow-2xl">
            <div class="p-6">
                <!-- Header -->
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-eye text-blue-600 text-2xl"></i>
                    </div>
                    <h2 class="text-xl font-bold text-gray-900 mb-2">Acompanhar Pedido</h2>
                    <p class="text-gray-600">Status atual do seu pedido</p>
                </div>
                
                <!-- Order Info -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-gray-700">N√∫mero do Pedido:</span>
                        <span id="order-number" class="text-sm font-bold text-orange-600">#12345</span>
                    </div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-gray-700">Total:</span>
                        <span id="order-total-tracking" class="text-sm font-bold text-gray-900">R$ 0,00</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm font-medium text-gray-700">Tempo estimado:</span>
                        <span id="estimated-time-tracking" class="text-sm font-bold text-gray-900">30-45 min</span>
                    </div>
                </div>
                
                <!-- Order Status -->
                <div class="mb-6">
                    <h3 class="text-sm font-semibold text-gray-900 mb-4">Status do Pedido</h3>
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-utensils text-white text-xs"></i>
                            </div>
                            <div class="flex-1">
                                <div class="text-sm font-medium text-gray-900">Preparando</div>
                                <div class="text-xs text-gray-500" id="status-time-1">Agora</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center">
                            <div id="status-tracking-2" class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-motorcycle text-white text-xs"></i>
                            </div>
                            <div class="flex-1">
                                <div id="status-tracking-2-text" class="text-sm font-medium text-gray-500">Em rota</div>
                                <div class="text-xs text-gray-400" id="status-time-2">Em breve</div>
                            </div>
                        </div>
                        
                        <div class="flex items-center">
                            <div id="status-tracking-3" class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-check text-white text-xs"></i>
                            </div>
                            <div class="flex-1">
                                <div id="status-tracking-3-text" class="text-sm font-medium text-gray-500">Finalizado</div>
                                <div class="text-xs text-gray-400" id="status-time-3">Em breve</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Actions -->
                <div class="space-y-3">
                    <button onclick="closeOrderTracking()" class="w-full bg-orange-500 text-white py-3 rounded-lg hover:bg-orange-600 transition-colors font-medium">
                        <i class="fas fa-check mr-2"></i>Entendi
                    </button>
                    <button onclick="shareOrder()" class="w-full bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium">
                        <i class="fas fa-share mr-2"></i>Compartilhar Pedido
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- PIX Payment Modal -->
    <div id="pix-payment-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-2xl w-full max-w-md slide-up shadow-2xl">
            <div class="p-6">
                <!-- Header -->
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-qrcode text-blue-600 text-2xl"></i>
                    </div>
                    <h2 class="text-xl font-bold text-gray-900 mb-2">Pagamento PIX</h2>
                    <p class="text-gray-600">Escaneie o QR Code ou copie a chave</p>
                </div>
                
                <!-- PIX QR Code -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <div class="text-center">
                        <div id="pix-qr-code-payment" class="w-48 h-48 mx-auto bg-white border-2 border-blue-300 rounded-lg flex items-center justify-center mb-3">
                            <span class="text-gray-400">QR Code PIX</span>
                        </div>
                        <div class="space-y-2">
                            <p class="text-xs text-blue-700">Chave PIX (Copia e Cola):</p>
                            <div class="flex items-center space-x-2">
                                <input type="text" id="pix-key-payment" readonly 
                                       class="flex-1 px-3 py-2 bg-gray-50 border border-gray-300 rounded text-xs font-mono"
                                       value="">
                                <button onclick="copyPixKeyPayment()" class="px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors text-xs">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Actions -->
                <div class="space-y-3">
                    <button onclick="finishPixPayment()" class="w-full bg-green-500 text-white py-3 rounded-lg hover:bg-green-600 transition-colors font-medium">
                        <i class="fas fa-check mr-2"></i>Pagamento Realizado
                    </button>
                    <button onclick="closePixPayment()" class="w-full bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium">
                        <i class="fas fa-arrow-left mr-2"></i>Voltar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Card Payment Modal -->
    <div id="card-payment-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-2xl w-full max-w-md slide-up shadow-2xl">
            <div class="p-6">
                <!-- Header -->
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-credit-card text-green-600 text-2xl"></i>
                    </div>
                    <h2 class="text-xl font-bold text-gray-900 mb-2">Checkout Seguro</h2>
                    <p class="text-gray-600">Finalize seu pagamento com seguran√ßa</p>
                </div>
                
                <!-- Payment Form -->
                <form id="card-payment-form" class="space-y-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">N√∫mero do cart√£o</label>
                        <input type="text" id="card-number-payment" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                               placeholder="0000 0000 0000 0000"
                               oninput="formatCardNumber(this)">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Validade</label>
                            <input type="text" id="card-expiry-payment" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                   placeholder="MM/AA"
                                   oninput="formatCardExpiry(this)">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">CVV</label>
                            <input type="text" id="card-cvv-payment" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                   placeholder="000"
                                   maxlength="4">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome no cart√£o</label>
                        <input type="text" id="card-name-payment" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                               placeholder="Nome como est√° no cart√£o">
                    </div>
                    
                    <!-- Total -->
                    <div class="bg-gray-50 rounded-lg p-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">Total a pagar:</span>
                            <span id="card-payment-total" class="text-lg font-bold text-green-600">R$ 0,00</span>
                        </div>
                    </div>
                </form>
                
                <!-- Actions -->
                <div class="space-y-3">
                    <button onclick="processCardPayment()" class="w-full bg-green-500 text-white py-3 rounded-lg hover:bg-green-600 transition-colors font-medium">
                        <i class="fas fa-lock mr-2"></i>Pagar Agora
                    </button>
                    <button onclick="closeCardPayment()" class="w-full bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium">
                        <i class="fas fa-arrow-left mr-2"></i>Voltar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-[calc(100%+2rem)] transition-transform duration-300 z-50">
        <div class="flex items-center space-x-2">
            <i class="fas fa-check-circle"></i>
            <span id="toast-message">Mensagem</span>
        </div>
    </div>

    <script>
        // Menu data
        const menuData = {
            burgers: [
                {
                    id: 1,
                    name: "X-Salada",
                    description: "Hamb√∫rguer bovino 120g, queijo, alface, tomate, cebola e maionese no p√£o de hamb√∫rguer",
                    price: 18.90,
                    icon: "üçî",
                    category: "burgers",
                    sizes: [
                        { name: "Tradicional", price: 0, description: "120g" },
                        { name: "Duplo", price: 6.00, description: "240g" }
                    ],
                    extras: [
                        { name: "Bacon", price: 4.00 },
                        { name: "Queijo Extra", price: 3.00 },
                        { name: "Ovo", price: 2.50 },
                        { name: "Batata Palha", price: 2.00 }
                    ]
                },
                {
                    id: 2,
                    name: "X-Bacon",
                    description: "Hamb√∫rguer bovino 120g, queijo, bacon crocante, alface, tomate e maionese",
                    price: 22.90,
                    icon: "ü•ì",
                    category: "burgers",
                    sizes: [
                        { name: "Tradicional", price: 0, description: "120g" },
                        { name: "Duplo", price: 6.00, description: "240g" }
                    ],
                    extras: [
                        { name: "Bacon Extra", price: 4.00 },
                        { name: "Queijo Extra", price: 3.00 },
                        { name: "Ovo", price: 2.50 },
                        { name: "Cebola Caramelizada", price: 2.50 }
                    ]
                },
                {
                    id: 3,
                    name: "X-Calabresa",
                    description: "Hamb√∫rguer bovino 120g, queijo, calabresa acebolada, alface, tomate e maionese",
                    price: 21.90,
                    icon: "üå∂Ô∏è",
                    category: "burgers",
                    sizes: [
                        { name: "Tradicional", price: 0, description: "120g" },
                        { name: "Duplo", price: 6.00, description: "240g" }
                    ],
                    extras: [
                        { name: "Calabresa Extra", price: 4.50 },
                        { name: "Queijo Extra", price: 3.00 },
                        { name: "Pimenta", price: 1.50 },
                        { name: "Cebola Extra", price: 2.00 }
                    ]
                }
            ],
            pizzas: [
                {
                    id: 4,
                    name: "Pizza Pequena",
                    description: "Pizza tradicional com 4 peda√ßos - escolha at√© 2 sabores",
                    price: 25.90,
                    icon: "üçï",
                    category: "pizzas",
                    flavors: [
                        { name: "Margherita", price: 0 },
                        { name: "Calabresa", price: 0 },
                        { name: "Portuguesa", price: 2.00 },
                        { name: "Frango com Catupiry", price: 3.00 },
                        { name: "Quatro Queijos", price: 4.00 },
                        { name: "Pepperoni", price: 5.00 }
                    ],
                    crusts: [
                        { name: "Tradicional", price: 0 },
                        { name: "Fina e Crocante", price: 0 },
                        { name: "Borda Recheada", price: 6.00 }
                    ],
                    extras: [
                        { name: "Queijo Extra", price: 4.00 },
                        { name: "Azeitona", price: 2.50 },
                        { name: "Or√©gano", price: 0.50 }
                    ]
                },
                {
                    id: 5,
                    name: "Pizza M√©dia",
                    description: "Pizza tradicional com 8 peda√ßos - escolha at√© 2 sabores",
                    price: 35.90,
                    icon: "üçï",
                    category: "pizzas",
                    flavors: [
                        { name: "Margherita", price: 0 },
                        { name: "Calabresa", price: 0 },
                        { name: "Portuguesa", price: 3.00 },
                        { name: "Frango com Catupiry", price: 4.00 },
                        { name: "Quatro Queijos", price: 5.00 },
                        { name: "Pepperoni", price: 6.00 }
                    ],
                    crusts: [
                        { name: "Tradicional", price: 0 },
                        { name: "Fina e Crocante", price: 0 },
                        { name: "Borda Recheada", price: 8.00 }
                    ],
                    extras: [
                        { name: "Queijo Extra", price: 5.00 },
                        { name: "Azeitona", price: 3.00 },
                        { name: "Or√©gano", price: 0.50 }
                    ]
                }
            ],
            drinks: [
                {
                    id: 6,
                    name: "Refrigerantes",
                    description: "Refrigerantes tradicionais gelados - diversas marcas e sabores",
                    price: 5.90,
                    icon: "ü•§",
                    category: "drinks",
                    brands: [
                        { name: "Coca-Cola", price: 0 },
                        { name: "Pepsi", price: 0 },
                        { name: "Guaran√° Antarctica", price: 0 },
                        { name: "Fanta Laranja", price: 0 },
                        { name: "Sprite", price: 0 },
                        { name: "Fanta Uva", price: 0.50 }
                    ],
                    sizes: [
                        { name: "Lata 350ml", price: 0 },
                        { name: "Garrafa 600ml", price: 2.00 },
                        { name: "Garrafa 1L", price: 3.50 },
                        { name: "Garrafa 2L", price: 6.00 }
                    ]
                },
                {
                    id: 7,
                    name: "Sucos",
                    description: "Sucos naturais frescos feitos na hora com frutas selecionadas",
                    price: 8.90,
                    icon: "üçä",
                    category: "drinks",
                    flavors: [
                        { name: "Laranja", price: 0 },
                        { name: "Lim√£o", price: 0 },
                        { name: "Maracuj√°", price: 1.00 },
                        { name: "Acerola", price: 1.00 },
                        { name: "Manga", price: 1.50 },
                        { name: "Abacaxi", price: 1.50 }
                    ],
                    sizes: [
                        { name: "300ml", price: 0 },
                        { name: "500ml", price: 3.00 },
                        { name: "700ml", price: 5.00 }
                    ]
                }
            ],
            desserts: [
                {
                    id: 8,
                    name: "Cookie",
                    description: "Cookies artesanais crocantes por fora e macios por dentro",
                    price: 6.90,
                    icon: "üç™",
                    category: "desserts",
                    flavors: [
                        { name: "Chocolate", price: 0 },
                        { name: "Baunilha", price: 0 },
                        { name: "Aveia e Passas", price: 0.50 },
                        { name: "Chocolate Branco", price: 1.00 },
                        { name: "Red Velvet", price: 1.50 },
                        { name: "Nutella", price: 2.00 }
                    ],
                    sizes: [
                        { name: "1 Unidade", price: 0 },
                        { name: "3 Unidades", price: 8.00 },
                        { name: "6 Unidades", price: 15.00 }
                    ]
                },
                {
                    id: 9,
                    name: "Brownie",
                    description: "Brownie de chocolate belga com nozes, servido quente",
                    price: 12.90,
                    icon: "üç´",
                    category: "desserts",
                    sizes: [
                        { name: "Individual", price: 0 },
                        { name: "Para Compartilhar", price: 8.00 }
                    ],
                    extras: [
                        { name: "Sorvete de Baunilha", price: 4.00 },
                        { name: "Calda Quente", price: 2.50 },
                        { name: "Chantilly", price: 3.00 },
                        { name: "Castanhas", price: 3.50 }
                    ]
                }
            ]
        };

        // State management
        let cart = [];
        let currentCategory = 'all';
        let currentSearchTerm = '';
        let currentProduct = null;
        let modalSelections = {
            size: null,
            crust: null,
            flavor: null,
            brand: null,
            extras: {},
            quantity: 1
        };

        // Render menu items
        function renderMenuItems() {
            const containerDesktop = document.getElementById('menu-items-desktop');
            const containerMobile = document.getElementById('menu-items-mobile');
            
            if (containerDesktop) containerDesktop.innerHTML = '';
            if (containerMobile) containerMobile.innerHTML = '';

            const allItems = Object.values(menuData).flat();
            let itemsToShow = currentCategory === 'all' ? allItems : (menuData[currentCategory] || []);
            
            if (currentSearchTerm) {
                itemsToShow = itemsToShow.filter(item => 
                    item.name.toLowerCase().includes(currentSearchTerm.toLowerCase()) ||
                    item.description.toLowerCase().includes(currentSearchTerm.toLowerCase())
                );
            }

            if (currentCategory === 'all' && !currentSearchTerm) {
                const categories = [
                    { key: 'burgers', name: 'üçî Hamb√∫rguers', items: menuData.burgers || [] },
                    { key: 'pizzas', name: 'üçï Pizzas', items: menuData.pizzas || [] },
                    { key: 'drinks', name: 'ü•§ Bebidas', items: menuData.drinks || [] },
                    { key: 'desserts', name: 'üç∞ Sobremesas', items: menuData.desserts || [] }
                ];

                categories.forEach((category, categoryIndex) => {
                    if (category.items && category.items.length > 0) {
                        if (containerDesktop) {
                            const headerDesktop = document.createElement('div');
                            headerDesktop.className = 'col-span-full mb-4';
                            headerDesktop.innerHTML = `
                                <div class="flex items-center ${categoryIndex > 0 ? 'mt-8' : ''}">
                                    <h2 class="text-xl font-bold text-gray-800">${category.name}</h2>
                                    <div class="flex-1 h-px bg-gradient-to-r from-orange-200 to-transparent ml-4"></div>
                                </div>
                            `;
                            containerDesktop.appendChild(headerDesktop);
                        }
                        
                        if (containerMobile) {
                            const headerMobile = document.createElement('div');
                            headerMobile.className = 'mb-4';
                            headerMobile.innerHTML = `
                                <div class="flex items-center ${categoryIndex > 0 ? 'mt-8' : ''}">
                                    <h2 class="text-lg font-bold text-gray-800">${category.name}</h2>
                                    <div class="flex-1 h-px bg-gradient-to-r from-orange-200 to-transparent ml-4"></div>
                                </div>
                            `;
                            containerMobile.appendChild(headerMobile);
                        }

                        category.items.forEach(item => {
                            if (containerDesktop) {
                                const desktopElement = createItemElement(item);
                                containerDesktop.appendChild(desktopElement);
                            }
                            
                            if (containerMobile) {
                                const mobileElement = createItemElement(item);
                                containerMobile.appendChild(mobileElement);
                            }
                        });
                    }
                });
            } else {
                itemsToShow.forEach(item => {
                    if (containerDesktop) {
                        const desktopElement = createItemElement(item);
                        containerDesktop.appendChild(desktopElement);
                    }
                    
                    if (containerMobile) {
                        const mobileElement = createItemElement(item);
                        containerMobile.appendChild(mobileElement);
                    }
                });
            }
        }

        function createItemElement(item) {
            const itemElement = document.createElement('div');
            itemElement.className = 'bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow cursor-pointer fade-in';
            itemElement.onclick = () => openProductModal(item);

            itemElement.innerHTML = `
                <div class="hidden md:block p-6">
                    <div class="w-full aspect-[4/3] bg-gradient-to-br from-orange-100 to-orange-200 rounded-lg overflow-hidden mb-4 flex items-center justify-center">
                        <span class="text-6xl">${item.icon}</span>
                    </div>
                    
                    <div class="mb-2">
                        <h3 class="text-lg font-semibold inline">${item.name}</h3>
                        <span class="text-gray-400 mx-2">‚Ä¢</span>
                        <span class="text-lg font-bold text-orange-500">R$ ${item.price.toFixed(2).replace('.', ',')}</span>
                    </div>
                    
                    <p class="text-gray-600 text-sm line-clamp-2">${item.description}</p>
                </div>
                
                <div class="md:hidden p-4">
                    <div class="flex space-x-3">
                        <div class="w-20 aspect-square bg-gradient-to-br from-orange-100 to-orange-200 rounded-lg overflow-hidden flex-shrink-0 flex items-center justify-center">
                            <span class="text-3xl">${item.icon}</span>
                        </div>
                        
                        <div class="flex-1">
                            <div class="mb-1">
                                <h3 class="text-base font-semibold inline">${item.name}</h3>
                                <span class="text-gray-400 mx-1">‚Ä¢</span>
                                <span class="text-base font-bold text-orange-500">R$ ${item.price.toFixed(2).replace('.', ',')}</span>
                            </div>
                            
                            <p class="text-gray-600 text-sm line-clamp-2">${item.description}</p>
                        </div>
                    </div>
                </div>
            `;

            return itemElement;
        }

        function filterCategory(category) {
            currentCategory = category;
            
            document.querySelectorAll('.category-btn-sidebar').forEach(btn => {
                btn.classList.remove('active', 'bg-orange-500', 'text-white');
                btn.classList.add('text-gray-600', 'hover:bg-gray-50', 'hover:text-orange-500');
            });
            
            document.querySelectorAll('.category-btn-mobile').forEach(btn => {
                btn.classList.remove('active', 'bg-orange-500', 'text-white');
                btn.classList.add('text-gray-600', 'bg-gray-100', 'hover:bg-orange-100', 'hover:text-orange-600');
            });
            
            if (event && event.target) {
                if (event.target.classList.contains('category-btn-sidebar')) {
                    event.target.classList.add('active', 'bg-orange-500', 'text-white');
                    event.target.classList.remove('text-gray-600', 'hover:bg-gray-50', 'hover:text-orange-500');
                } else if (event.target.classList.contains('category-btn-mobile')) {
                    event.target.classList.add('active', 'bg-orange-500', 'text-white');
                    event.target.classList.remove('text-gray-600', 'bg-gray-100', 'hover:bg-orange-100', 'hover:text-orange-600');
                }
            }
            
            renderMenuItems();
        }

        function searchProducts() {
            const searchInputMobile = document.getElementById('search-input-mobile');
            const searchInputDesktop = document.getElementById('search-input-desktop');
            
            if (searchInputMobile) {
                currentSearchTerm = searchInputMobile.value.trim();
            }
            if (searchInputDesktop) {
                currentSearchTerm = searchInputDesktop.value.trim();
            }
            
            renderMenuItems();
        }

        function openProductModal(item) {
            currentProduct = item;
            modalSelections = {
                size: item.sizes ? item.sizes[0] : null,
                crust: item.crusts ? item.crusts[0] : null,
                flavor: item.flavors ? item.flavors[0] : null,
                brand: item.brands ? item.brands[0] : null,
                extras: {},
                quantity: 1
            };

            const modal = document.getElementById('product-modal');
            const content = document.getElementById('modal-content');

            const modalContent = generateModalContent(item);
            content.innerHTML = modalContent;

            modal.classList.remove('hidden');
            updateModalPrice();
        }

        function generateModalContent(item) {
            let optionsHtml = '';

            if (item.sizes) {
                optionsHtml += `
                    <div class="mb-5">
                        <h3 class="text-sm font-medium mb-3 text-gray-900">Tamanho</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                            ${item.sizes.map(size => `
                                <button onclick="selectSize('${size.name}', ${size.price})" class="size-option p-3 border border-gray-200 rounded-lg transition-all text-left hover:border-orange-300 hover:bg-orange-50 ${modalSelections.size?.name === size.name ? 'border-orange-500 bg-orange-50' : ''}">
                                    <div class="text-sm font-medium text-gray-900">${size.name}${size.price !== 0 ? ` ‚Ä¢ <span class="text-orange-600">+R$ ${size.price.toFixed(2).replace('.', ',')}</span>` : ''}</div>
                                    ${size.description ? `<div class="text-xs text-gray-500 mt-0.5">${size.description}</div>` : ''}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            if (item.crusts) {
                optionsHtml += `
                    <div class="mb-5">
                        <h3 class="text-sm font-medium mb-3 text-gray-900">Massa</h3>
                        <div class="grid grid-cols-1 gap-2">
                            ${item.crusts.map(crust => `
                                <button onclick="selectCrust('${crust.name}', ${crust.price})" class="crust-option p-3 border border-gray-200 rounded-lg transition-all text-left hover:border-orange-300 hover:bg-orange-50 ${modalSelections.crust?.name === crust.name ? 'border-orange-500 bg-orange-50' : ''}">
                                    <div class="text-sm font-medium text-gray-900">${crust.name}${crust.price !== 0 ? ` ‚Ä¢ <span class="text-orange-600">+R$ ${crust.price.toFixed(2).replace('.', ',')}</span>` : ''}</div>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            if (item.flavors) {
                optionsHtml += `
                    <div class="mb-5">
                        <h3 class="text-sm font-medium mb-3 text-gray-900">Sabor</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                            ${item.flavors.map(flavor => `
                                <button onclick="selectFlavor('${flavor.name}', ${flavor.price})" class="flavor-option p-3 border border-gray-200 rounded-lg transition-all text-left hover:border-orange-300 hover:bg-orange-50 ${modalSelections.flavor?.name === flavor.name ? 'border-orange-500 bg-orange-50' : ''}">
                                    <div class="text-sm font-medium text-gray-900">${flavor.name}${flavor.price !== 0 ? ` ‚Ä¢ <span class="text-orange-600">+R$ ${flavor.price.toFixed(2).replace('.', ',')}</span>` : ''}</div>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            if (item.brands) {
                optionsHtml += `
                    <div class="mb-5">
                        <h3 class="text-sm font-medium mb-3 text-gray-900">Marca</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                            ${item.brands.map(brand => `
                                <button onclick="selectBrand('${brand.name}', ${brand.price})" class="brand-option p-3 border border-gray-200 rounded-lg transition-all text-left hover:border-orange-300 hover:bg-orange-50 ${modalSelections.brand?.name === brand.name ? 'border-orange-500 bg-orange-50' : ''}">
                                    <div class="text-sm font-medium text-gray-900">${brand.name}${brand.price !== 0 ? ` ‚Ä¢ <span class="text-orange-600">+R$ ${brand.price.toFixed(2).replace('.', ',')}</span>` : ''}</div>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            if (item.extras && item.extras.length > 0) {
                optionsHtml += `
                    <div class="mb-5">
                        <h3 class="text-sm font-medium mb-3 text-gray-900">Adicionais</h3>
                        <div class="space-y-2">
                            ${item.extras.map((extra, index) => `
                                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:border-orange-300 transition-colors">
                                    <div class="flex-1">
                                        <div class="text-sm font-medium text-gray-900">${extra.name} ‚Ä¢ <span class="text-orange-600">R$ ${extra.price.toFixed(2).replace('.', ',')}</span></div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <button onclick="changeExtraQuantity('${extra.name.replace(/'/g, "\\'")}', ${extra.price}, -1)" class="w-7 h-7 bg-gray-100 rounded-md flex items-center justify-center hover:bg-gray-200 transition-colors">
                                            <i class="fas fa-minus text-gray-600 text-xs"></i>
                                        </button>
                                        <span id="extra-qty-${extra.name.replace(/[^a-zA-Z0-9]/g, '_')}" class="font-medium text-sm min-w-[1.25rem] text-center">0</span>
                                        <button onclick="changeExtraQuantity('${extra.name.replace(/'/g, "\\'")}', ${extra.price}, 1)" class="w-7 h-7 bg-orange-500 rounded-md flex items-center justify-center hover:bg-orange-600 transition-colors">
                                            <i class="fas fa-plus text-white text-xs"></i>
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            return `
                <div class="flex flex-col h-full max-h-[90vh] md:max-h-[85vh]">
                    <div class="flex-shrink-0 p-4 md:p-6 border-b border-gray-100">
                        <div class="flex items-start justify-between">
                            <div class="flex-1 pr-4">
                                <h2 class="text-lg md:text-xl font-bold text-gray-900 leading-tight">${item.name}</h2>
                            </div>
                            <button onclick="closeModal()" class="flex-shrink-0 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>

                    <div class="flex-1 overflow-y-auto">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8 p-4 md:p-6">
                            <!-- Left Column - Image and Description -->
                            <div class="space-y-5">
                                <div class="w-full aspect-[16/10] md:aspect-square bg-gradient-to-br from-orange-100 to-orange-200 rounded-xl overflow-hidden flex items-center justify-center">
                                    <span class="text-8xl md:text-9xl">${item.icon}</span>
                                </div>

                                <div>
                                    <p class="text-sm text-gray-600 leading-relaxed">${item.description}</p>
                                </div>

                                <div class="lg:hidden">
                                    <h3 class="text-sm font-medium mb-3 text-gray-900">Observa√ß√µes</h3>
                                    <textarea id="modal-observations" placeholder="Alguma observa√ß√£o especial?" class="w-full p-3 border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors text-sm" rows="3"></textarea>
                                </div>
                            </div>

                            <!-- Right Column - Options -->
                            <div class="space-y-5">
                                ${optionsHtml}

                                <div class="hidden lg:block">
                                    <h3 class="text-sm font-medium mb-3 text-gray-900">Observa√ß√µes</h3>
                                    <textarea id="modal-observations" placeholder="Alguma observa√ß√£o especial?" class="w-full p-3 border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors text-sm" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex-shrink-0 p-4 md:p-6 border-t border-gray-100 bg-white">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-2">
                                <span class="text-base font-medium text-gray-900 h-7 flex items-center">Quantidade:</span>
                                <div class="flex items-center space-x-2">
                                    <button onclick="changeModalQuantity(-1)" class="w-7 h-7 bg-gray-100 rounded-md flex items-center justify-center hover:bg-gray-200 transition-colors">
                                        <i class="fas fa-minus text-gray-600 text-xs"></i>
                                    </button>
                                    <span id="modal-quantity" class="font-medium text-sm min-w-[1.25rem] text-center">1</span>
                                    <button onclick="changeModalQuantity(1)" class="w-7 h-7 bg-orange-500 rounded-md flex items-center justify-center hover:bg-orange-600 transition-colors">
                                        <i class="fas fa-plus text-white text-xs"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="text-base font-medium text-gray-900 h-7 flex items-center">Total:</span>
                                <span id="modal-total-price" class="text-base font-medium text-orange-600 h-7 flex items-center">R$ ${item.price.toFixed(2).replace('.', ',')}</span>
                            </div>
                        </div>
                        <button onclick="addToCartFromModal()" class="w-full bg-orange-500 text-white py-3 md:py-4 rounded-xl hover:bg-orange-600 transition-colors font-semibold text-sm md:text-base">
                            <i class="fas fa-shopping-cart mr-2"></i>
                            Adicionar ao Carrinho
                        </button>
                    </div>
                </div>
            `;
        }

        function selectSize(name, price) {
            modalSelections.size = { name, price };
            updateSelectionUI('size-option', name);
            updateModalPrice();
        }

        function selectCrust(name, price) {
            modalSelections.crust = { name, price };
            updateSelectionUI('crust-option', name);
            updateModalPrice();
        }

        function selectFlavor(name, price) {
            modalSelections.flavor = { name, price };
            updateSelectionUI('flavor-option', name);
            updateModalPrice();
        }

        function selectBrand(name, price) {
            modalSelections.brand = { name, price };
            updateSelectionUI('brand-option', name);
            updateModalPrice();
        }

        function updateSelectionUI(className, selectedName) {
            document.querySelectorAll(`.${className}`).forEach(btn => {
                btn.classList.remove('border-orange-500', 'bg-orange-50');
                btn.classList.add('border-gray-200');
            });
            
            const selectedBtn = Array.from(document.querySelectorAll(`.${className}`))
                .find(btn => btn.textContent.includes(selectedName));
            if (selectedBtn) {
                selectedBtn.classList.add('border-orange-500', 'bg-orange-50');
                selectedBtn.classList.remove('border-gray-200');
            }
        }

        function changeExtraQuantity(extraName, extraPrice, delta) {
            if (!modalSelections.extras[extraName]) {
                modalSelections.extras[extraName] = { quantity: 0, price: extraPrice };
            }
            
            const newQuantity = Math.max(0, modalSelections.extras[extraName].quantity + delta);
            
            if (newQuantity === 0) {
                delete modalSelections.extras[extraName];
            } else {
                modalSelections.extras[extraName].quantity = newQuantity;
            }
            
            const sanitizedName = extraName.replace(/[^a-zA-Z0-9]/g, '_');
            const qtyElement = document.getElementById(`extra-qty-${sanitizedName}`);
            
            if (qtyElement) {
                qtyElement.textContent = newQuantity;
            }
            
            updateModalPrice();
        }

        function changeModalQuantity(delta) {
            modalSelections.quantity = Math.max(1, modalSelections.quantity + delta);
            
            const quantityElement = document.getElementById('modal-quantity');
            if (quantityElement) {
                quantityElement.textContent = modalSelections.quantity;
            }
            
            updateModalPrice();
        }

        function updateModalPrice() {
            let totalPrice = currentProduct.price;
            
            if (modalSelections.size) totalPrice += modalSelections.size.price;
            if (modalSelections.crust) totalPrice += modalSelections.crust.price;
            if (modalSelections.flavor) totalPrice += modalSelections.flavor.price;
            if (modalSelections.brand) totalPrice += modalSelections.brand.price;
            
            Object.values(modalSelections.extras).forEach(extra => {
                totalPrice += extra.price * extra.quantity;
            });
            
            totalPrice *= modalSelections.quantity;
            
            const totalElement = document.getElementById('modal-total-price');
            if (totalElement) {
                totalElement.textContent = `R$ ${totalPrice.toFixed(2).replace('.', ',')}`;
            }
        }

        function generateEditModalContent(item, cartItem) {
            let optionsHtml = '';

            if (item.sizes) {
                optionsHtml += `
                    <div class="mb-5">
                        <h3 class="text-sm font-medium mb-3 text-gray-900">Tamanho</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                            ${item.sizes.map(size => `
                                <button onclick="selectSize('${size.name}', ${size.price})" class="size-option p-3 border border-gray-200 rounded-lg transition-all text-left hover:border-orange-300 hover:bg-orange-50 ${modalSelections.size?.name === size.name ? 'border-orange-500 bg-orange-50' : ''}">
                                    <div class="text-sm font-medium text-gray-900">${size.name}${size.price !== 0 ? ` ‚Ä¢ <span class="text-orange-600">+R$ ${size.price.toFixed(2).replace('.', ',')}</span>` : ''}</div>
                                    ${size.description ? `<div class="text-xs text-gray-500 mt-0.5">${size.description}</div>` : ''}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            if (item.crusts) {
                optionsHtml += `
                    <div class="mb-5">
                        <h3 class="text-sm font-medium mb-3 text-gray-900">Massa</h3>
                        <div class="grid grid-cols-1 gap-2">
                            ${item.crusts.map(crust => `
                                <button onclick="selectCrust('${crust.name}', ${crust.price})" class="crust-option p-3 border border-gray-200 rounded-lg transition-all text-left hover:border-orange-300 hover:bg-orange-50 ${modalSelections.crust?.name === crust.name ? 'border-orange-500 bg-orange-50' : ''}">
                                    <div class="text-sm font-medium text-gray-900">${crust.name}${crust.price !== 0 ? ` ‚Ä¢ <span class="text-orange-600">+R$ ${crust.price.toFixed(2).replace('.', ',')}</span>` : ''}</div>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            if (item.flavors) {
                optionsHtml += `
                    <div class="mb-5">
                        <h3 class="text-sm font-medium mb-3 text-gray-900">Sabor</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                            ${item.flavors.map(flavor => `
                                <button onclick="selectFlavor('${flavor.name}', ${flavor.price})" class="flavor-option p-3 border border-gray-200 rounded-lg transition-all text-left hover:border-orange-300 hover:bg-orange-50 ${modalSelections.flavor?.name === flavor.name ? 'border-orange-500 bg-orange-50' : ''}">
                                    <div class="text-sm font-medium text-gray-900">${flavor.name}${flavor.price !== 0 ? ` ‚Ä¢ <span class="text-orange-600">+R$ ${flavor.price.toFixed(2).replace('.', ',')}</span>` : ''}</div>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            if (item.brands) {
                optionsHtml += `
                    <div class="mb-5">
                        <h3 class="text-sm font-medium mb-3 text-gray-900">Marca</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                            ${item.brands.map(brand => `
                                <button onclick="selectBrand('${brand.name}', ${brand.price})" class="brand-option p-3 border border-gray-200 rounded-lg transition-all text-left hover:border-orange-300 hover:bg-orange-50 ${modalSelections.brand?.name === brand.name ? 'border-orange-500 bg-orange-50' : ''}">
                                    <div class="text-sm font-medium text-gray-900">${brand.name}${brand.price !== 0 ? ` ‚Ä¢ <span class="text-orange-600">+R$ ${brand.price.toFixed(2).replace('.', ',')}</span>` : ''}</div>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            if (item.extras && item.extras.length > 0) {
                optionsHtml += `
                    <div class="mb-5">
                        <h3 class="text-sm font-medium mb-3 text-gray-900">Adicionais</h3>
                        <div class="space-y-2">
                            ${item.extras.map((extra, index) => `
                                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:border-orange-300 transition-colors">
                                    <div class="flex-1">
                                        <div class="text-sm font-medium text-gray-900">${extra.name} ‚Ä¢ <span class="text-orange-600">R$ ${extra.price.toFixed(2).replace('.', ',')}</span></div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <button onclick="changeExtraQuantity('${extra.name.replace(/'/g, "\\'")}', ${extra.price}, -1)" class="w-7 h-7 bg-gray-100 rounded-md flex items-center justify-center hover:bg-gray-200 transition-colors">
                                            <i class="fas fa-minus text-gray-600 text-xs"></i>
                                        </button>
                                        <span id="extra-qty-${extra.name.replace(/[^a-zA-Z0-9]/g, '_')}" class="font-medium text-sm min-w-[1.25rem] text-center">0</span>
                                        <button onclick="changeExtraQuantity('${extra.name.replace(/'/g, "\\'")}', ${extra.price}, 1)" class="w-7 h-7 bg-orange-500 rounded-md flex items-center justify-center hover:bg-orange-600 transition-colors">
                                            <i class="fas fa-plus text-white text-xs"></i>
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            return `
                <div class="flex flex-col h-full max-h-[90vh] md:max-h-[85vh]">
                    <div class="flex-shrink-0 p-4 md:p-6 border-b border-gray-100">
                        <div class="flex items-start justify-between">
                            <div class="flex-1 pr-4">
                                <h2 class="text-lg md:text-xl font-bold text-gray-900 leading-tight">Editar ‚Ä¢ ${item.name}</h2>
                                <p class="text-sm text-orange-600 mt-1">Modifique as op√ß√µes do seu produto</p>
                            </div>
                            <button onclick="closeModal()" class="flex-shrink-0 w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>

                    <div class="flex-1 overflow-y-auto">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8 p-4 md:p-6">
                            <!-- Left Column - Image and Description -->
                            <div class="space-y-5">
                                <div class="w-full aspect-[16/10] md:aspect-square bg-gradient-to-br from-orange-100 to-orange-200 rounded-xl overflow-hidden flex items-center justify-center">
                                    <span class="text-8xl md:text-9xl">${item.icon}</span>
                                </div>

                                <div>
                                    <p class="text-sm text-gray-600 leading-relaxed">${item.description}</p>
                                </div>

                                <div class="lg:hidden">
                                    <h3 class="text-sm font-medium mb-3 text-gray-900">Observa√ß√µes</h3>
                                    <textarea id="modal-observations" placeholder="Alguma observa√ß√£o especial?" class="w-full p-3 border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors text-sm" rows="3">${cartItem.observations || ''}</textarea>
                                </div>
                            </div>

                            <!-- Right Column - Options -->
                            <div class="space-y-5">
                                ${optionsHtml}

                                <div class="hidden lg:block">
                                    <h3 class="text-sm font-medium mb-3 text-gray-900">Observa√ß√µes</h3>
                                    <textarea id="modal-observations" placeholder="Alguma observa√ß√£o especial?" class="w-full p-3 border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors text-sm" rows="3">${cartItem.observations || ''}</textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex-shrink-0 p-4 md:p-6 border-t border-gray-100 bg-white">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-2">
                                <span class="text-base font-medium text-gray-900 h-7 flex items-center">Quantidade:</span>
                                <div class="flex items-center space-x-2">
                                    <button onclick="changeModalQuantity(-1)" class="w-7 h-7 bg-gray-100 rounded-md flex items-center justify-center hover:bg-gray-200 transition-colors">
                                        <i class="fas fa-minus text-gray-600 text-xs"></i>
                                    </button>
                                    <span id="modal-quantity" class="font-medium text-sm min-w-[1.25rem] text-center">${modalSelections.quantity}</span>
                                    <button onclick="changeModalQuantity(1)" class="w-7 h-7 bg-orange-500 rounded-md flex items-center justify-center hover:bg-orange-600 transition-colors">
                                        <i class="fas fa-plus text-white text-xs"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="text-base font-medium text-gray-900 h-7 flex items-center">Total:</span>
                                <span id="modal-total-price" class="text-base font-medium text-orange-600 h-7 flex items-center">R$ ${item.price.toFixed(2).replace('.', ',')}</span>
                            </div>
                        </div>
                        <div class="flex gap-3">
                            <button onclick="removeCartItemFromModal('${cartItem.id}')" class="w-32 md:w-40 bg-red-100 text-red-600 py-3 rounded-xl hover:bg-red-200 transition-colors font-medium">
                                <i class="fas fa-trash mr-2"></i>Remover
                            </button>
                            <button onclick="updateCartFromModal()" class="flex-1 bg-orange-500 text-white py-3 rounded-xl hover:bg-orange-600 transition-colors font-semibold text-sm md:text-base">
                                <i class="fas fa-check mr-2"></i>Atualizar Produto
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function addToCartFromModal() {
            if (!currentProduct) return;
            
            const observations = document.getElementById('modal-observations')?.value || '';
            
            let finalPrice = currentProduct.price;
            
            if (modalSelections.size) finalPrice += modalSelections.size.price;
            if (modalSelections.crust) finalPrice += modalSelections.crust.price;
            if (modalSelections.flavor) finalPrice += modalSelections.flavor.price;
            if (modalSelections.brand) finalPrice += modalSelections.brand.price;
            
            Object.values(modalSelections.extras).forEach(extra => {
                finalPrice += extra.price * extra.quantity;
            });
            
            const cartItem = {
                id: Date.now() + Math.random(),
                productId: currentProduct.id,
                name: currentProduct.name,
                icon: currentProduct.icon,
                basePrice: currentProduct.price,
                finalPrice: finalPrice,
                quantity: modalSelections.quantity,
                observations: observations,
                selections: { ...modalSelections }
            };
            
            cart.push(cartItem);
            updateCartUI();
            closeModal();
            
            showToast('Produto adicionado ao carrinho!');
        }

        function updateCartFromModal() {
            if (!currentProduct || !modalSelections.editingItemId) return;
            
            const observations = document.getElementById('modal-observations')?.value || '';
            
            let finalPrice = currentProduct.price;
            
            if (modalSelections.size) finalPrice += modalSelections.size.price;
            if (modalSelections.crust) finalPrice += modalSelections.crust.price;
            if (modalSelections.flavor) finalPrice += modalSelections.flavor.price;
            if (modalSelections.brand) finalPrice += modalSelections.brand.price;
            
            Object.values(modalSelections.extras).forEach(extra => {
                finalPrice += extra.price * extra.quantity;
            });
            
            // Find and update the cart item
            const itemIndex = cart.findIndex(item => item.id === modalSelections.editingItemId);
            if (itemIndex !== -1) {
                cart[itemIndex] = {
                    ...cart[itemIndex],
                    finalPrice: finalPrice,
                    quantity: modalSelections.quantity,
                    observations: observations,
                    selections: { ...modalSelections }
                };
                
                updateCartUI();
                closeModal();
                showToast('Produto atualizado com sucesso!');
            }
        }

        function removeCartItemFromModal(itemId) {
            cart = cart.filter(item => item.id != itemId);
            updateCartUI();
            closeModal();
            showToast('Item removido do carrinho');
        }

        function closeModal() {
            const modal = document.getElementById('product-modal');
            modal.classList.add('hidden');
            
            currentProduct = null;
            modalSelections = {
                size: null,
                crust: null,
                flavor: null,
                brand: null,
                extras: {},
                quantity: 1
            };
        }

        function toggleCart() {
            const cartSidebarDesktop = document.getElementById('cart-sidebar-desktop');
            const cartModalMobile = document.getElementById('cart-modal-mobile');
            const cartContentMobile = document.getElementById('cart-content-mobile');
            
            if (window.innerWidth >= 640) {
                if (cartSidebarDesktop.classList.contains('translate-x-full')) {
                    cartSidebarDesktop.classList.remove('translate-x-full');
                } else {
                    cartSidebarDesktop.classList.add('translate-x-full');
                }
            } else {
                if (cartModalMobile.classList.contains('hidden')) {
                    cartModalMobile.classList.remove('hidden');
                    setTimeout(() => {
                        cartContentMobile.classList.remove('translate-y-full');
                    }, 10);
                } else {
                    cartContentMobile.classList.add('translate-y-full');
                    setTimeout(() => {
                        cartModalMobile.classList.add('hidden');
                    }, 300);
                }
            }
        }

        function updateCartUI() {
            const cartItemsDesktop = document.getElementById('cart-items-desktop');
            const cartItemsMobile = document.getElementById('cart-items-mobile');
            const emptyCartDesktop = document.getElementById('empty-cart-desktop');
            const emptyCartMobile = document.getElementById('empty-cart-mobile');
            const cartTotalDesktop = document.getElementById('cart-total-desktop');
            const cartTotalMobile = document.getElementById('cart-total-mobile');
            const cartCountDesktop = document.getElementById('cart-count-desktop');
            const cartCountMobile = document.getElementById('cart-count-mobile');
            
            if (cartItemsDesktop) cartItemsDesktop.innerHTML = '';
            if (cartItemsMobile) cartItemsMobile.innerHTML = '';
            
            if (cart.length === 0) {
                if (emptyCartDesktop) emptyCartDesktop.classList.remove('hidden');
                if (emptyCartMobile) emptyCartMobile.classList.remove('hidden');
                if (cartCountDesktop) cartCountDesktop.classList.add('hidden');
                if (cartCountMobile) cartCountMobile.classList.add('hidden');
                if (cartTotalDesktop) cartTotalDesktop.textContent = 'R$ 0,00';
                if (cartTotalMobile) cartTotalMobile.textContent = 'R$ 0,00';
            } else {
                if (emptyCartDesktop) emptyCartDesktop.classList.add('hidden');
                if (emptyCartMobile) emptyCartMobile.classList.add('hidden');
                
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                if (cartCountDesktop) {
                    cartCountDesktop.textContent = totalItems;
                    cartCountDesktop.classList.remove('hidden');
                }
                if (cartCountMobile) {
                    cartCountMobile.textContent = totalItems;
                    cartCountMobile.classList.remove('hidden');
                }
                
                const total = cart.reduce((sum, item) => sum + (item.finalPrice * item.quantity), 0);
                if (cartTotalDesktop) cartTotalDesktop.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
                if (cartTotalMobile) cartTotalMobile.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
                
                cart.forEach(item => {
                    const itemElement = createCartItemElement(item);
                    if (cartItemsDesktop) cartItemsDesktop.appendChild(itemElement.cloneNode(true));
                    if (cartItemsMobile) cartItemsMobile.appendChild(itemElement);
                });
            }
        }

        function createCartItemElement(item) {
            const itemElement = document.createElement('div');
            itemElement.className = 'bg-white rounded-xl shadow-sm hover:shadow-md transition-all duration-200 border border-gray-100 cursor-pointer';
            itemElement.onclick = () => editCartItem(item);
            
            itemElement.innerHTML = `
                <div class="p-4">
                    <div class="flex items-start space-x-3">
                        <!-- Product icon -->
                        <div class="w-12 h-12 bg-gradient-to-br from-orange-100 to-orange-200 rounded-lg flex items-center justify-center flex-shrink-0">
                            <span class="text-2xl">${item.icon}</span>
                        </div>
                        
                        <!-- Product info -->
                        <div class="flex-1 min-w-0">
                            <div class="flex items-start justify-between mb-1">
                                <h4 class="font-semibold text-gray-900 text-sm leading-tight">${item.quantity} ‚Ä¢ ${item.name}</h4>
                                <button onclick="event.stopPropagation(); removeCartItem('${item.id}')" class="ml-2 px-2 py-1 bg-gray-100 hover:bg-red-100 text-red-500 hover:text-red-600 transition-colors rounded-md flex items-center space-x-1 flex-shrink-0">
                                    <span class="text-xs font-medium">Remover</span>
                                    <i class="fas fa-trash text-xs"></i>
                                </button>
                            </div>
                            
                            <!-- Product configurations and price -->
                            <div class="flex justify-between items-start">
                                <div class="flex-1 pr-3">
                                    ${(() => {
                                        let configText = '';
                                        const selections = item.selections;
                                        
                                        // Build configuration text
                                        let configs = [];
                                        if (selections.size) configs.push(selections.size.name);
                                        if (selections.crust) configs.push(selections.crust.name);
                                        if (selections.flavor) configs.push(selections.flavor.name);
                                        if (selections.brand) configs.push(selections.brand.name);
                                        
                                        // Add extras
                                        Object.entries(selections.extras).forEach(([name, extra]) => {
                                            configs.push(`+${extra.quantity}x ${name}`);
                                        });
                                        
                                        configText = configs.join(', ');
                                        
                                        return configText ? `<p class="text-xs text-gray-600 mb-1">${configText}</p>` : '';
                                    })()}
                                    
                                    ${item.observations ? `<p class="text-xs text-gray-500 italic">"${item.observations}"</p>` : ''}
                                </div>
                                
                                <!-- Price -->
                                <div class="text-right flex-shrink-0">
                                    ${item.quantity > 1 ? 
                                        `<div class="text-xs text-gray-500 mb-1">Cada: R$ ${item.finalPrice.toFixed(2).replace('.', ',')}</div><div class="text-sm font-bold text-orange-600">Total: R$ ${(item.finalPrice * item.quantity).toFixed(2).replace('.', ',')}</div>` :
                                        `<div class="text-sm font-bold text-orange-600">R$ ${(item.finalPrice * item.quantity).toFixed(2).replace('.', ',')}</div>`
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            return itemElement;
        }

        function removeCartItem(itemId) {
            cart = cart.filter(item => item.id != itemId);
            updateCartUI();
            showToast('Item removido do carrinho');
        }

        function editCartItem(cartItem) {
            // Find the original product
            const allItems = Object.values(menuData).flat();
            const originalProduct = allItems.find(item => item.id === cartItem.productId);
            
            if (!originalProduct) {
                showToast('Produto n√£o encontrado');
                return;
            }
            
            // Set current product and restore selections
            currentProduct = originalProduct;
            modalSelections = {
                size: cartItem.selections.size,
                crust: cartItem.selections.crust,
                flavor: cartItem.selections.flavor,
                brand: cartItem.selections.brand,
                extras: { ...cartItem.selections.extras },
                quantity: cartItem.selections.quantity
            };
            
            // Store the cart item ID for updating
            modalSelections.editingItemId = cartItem.id;
            
            const modal = document.getElementById('product-modal');
            const content = document.getElementById('modal-content');

            const modalContent = generateEditModalContent(originalProduct, cartItem);
            content.innerHTML = modalContent;

            modal.classList.remove('hidden');
            updateModalPrice();
            
            // Restore extra quantities in UI
            Object.entries(cartItem.selections.extras).forEach(([extraName, extra]) => {
                const sanitizedName = extraName.replace(/[^a-zA-Z0-9]/g, '_');
                const qtyElement = document.getElementById(`extra-qty-${sanitizedName}`);
                if (qtyElement) {
                    qtyElement.textContent = extra.quantity;
                }
            });
        }

        function checkout() {
            if (cart.length === 0) {
                showToast('Seu carrinho est√° vazio!');
                return;
            }
            
            openCheckoutModal();
        }

        function openCheckoutModal() {
            const modal = document.getElementById('checkout-modal');
            const orderSummary = document.getElementById('checkout-order-summary');
            const checkoutTotal = document.getElementById('checkout-total');
            
            // Populate order summary
            orderSummary.innerHTML = '';
            cart.forEach(item => {
                let selectionsText = '';
                const selections = item.selections;
                
                if (selections.size) selectionsText += `${selections.size.name}, `;
                if (selections.crust) selectionsText += `${selections.crust.name}, `;
                if (selections.flavor) selectionsText += `${selections.flavor.name}, `;
                if (selections.brand) selectionsText += `${selections.brand.name}, `;
                
                Object.entries(selections.extras).forEach(([name, extra]) => {
                    selectionsText += `${extra.quantity}x ${name}, `;
                });
                
                selectionsText = selectionsText.replace(/, $/, '');
                
                const itemElement = document.createElement('div');
                itemElement.className = 'flex justify-between items-start';
                itemElement.innerHTML = `
                    <div class="flex-1">
                        <div class="text-sm font-medium text-gray-900">${item.quantity} ‚Ä¢ ${item.name}</div>
                        ${selectionsText ? `<div class="text-xs text-gray-600">${selectionsText}</div>` : ''}
                        ${item.observations ? `<div class="text-xs text-gray-500 italic">"${item.observations}"</div>` : ''}
                    </div>
                    <div class="text-sm font-semibold text-orange-600 ml-4">R$ ${(item.finalPrice * item.quantity).toFixed(2).replace('.', ',')}</div>
                `;
                orderSummary.appendChild(itemElement);
            });
            
            // Update total
            const total = cart.reduce((sum, item) => sum + (item.finalPrice * item.quantity), 0);
            checkoutTotal.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
            
            modal.classList.remove('hidden');
        }

        function closeCheckoutModal() {
            const modal = document.getElementById('checkout-modal');
            modal.classList.add('hidden');
            
            // Reset form
            document.getElementById('checkout-form').reset();
        }

        // Toggle delivery fields
        function toggleDeliveryFields() {
            const deliveryFields = document.getElementById('delivery-fields');
            const orderMode = document.querySelector('input[name="order-mode"]:checked')?.value;
            
            if (orderMode === 'delivery') {
                deliveryFields.classList.remove('hidden');
                // Make delivery fields required
                document.getElementById('delivery-cep').required = true;
            } else {
                deliveryFields.classList.add('hidden');
                // Remove required from delivery fields
                document.getElementById('delivery-cep').required = false;
            }
        }

        // Toggle payment fields
        function togglePaymentFields() {
            const paymentMethod = document.querySelector('input[name="payment-method"]:checked')?.value;
            
            // Hide all payment fields
            document.getElementById('pix-fields').classList.add('hidden');
            document.getElementById('card-online-fields').classList.add('hidden');
            document.getElementById('cash-fields').classList.add('hidden');
            document.getElementById('card-machine-fields').classList.add('hidden');
            
            // Show relevant payment field
            if (paymentMethod === 'pix') {
                document.getElementById('pix-fields').classList.remove('hidden');
                generatePixQRCode();
            } else if (paymentMethod === 'card-online') {
                document.getElementById('card-online-fields').classList.remove('hidden');
            } else if (paymentMethod === 'cash') {
                document.getElementById('cash-fields').classList.remove('hidden');
            } else if (paymentMethod === 'card-machine') {
                document.getElementById('card-machine-fields').classList.remove('hidden');
            }
        }

        // Toggle change field for cash payment
        function toggleChangeField() {
            const needsChange = document.getElementById('needs-change').checked;
            const changeField = document.getElementById('change-field');
            
            if (needsChange) {
                changeField.classList.remove('hidden');
            } else {
                changeField.classList.add('hidden');
                document.getElementById('cash-amount').value = '';
                document.getElementById('change-amount').textContent = '';
            }
        }

        // Format CEP
        function formatCEP(input) {
            let value = input.value.replace(/\D/g, '');
            value = value.replace(/(\d{5})(\d{3})/, '$1-$2');
            input.value = value;
        }

        // Search CEP (mock function)
        function searchCEP(cep) {
            const cleanCEP = cep.replace(/\D/g, '');
            if (cleanCEP.length === 8) {
                // Mock CEP data
                document.getElementById('delivery-street').value = 'Rua das Flores';
                document.getElementById('delivery-neighborhood').value = 'Centro';
                document.getElementById('delivery-city').value = 'Palmas';
                showToast('CEP encontrado!');
            }
        }

        // Format card number
        function formatCardNumber(input) {
            let value = input.value.replace(/\D/g, '');
            value = value.replace(/(\d{4})(?=\d)/g, '$1 ');
            input.value = value;
        }

        // Format card expiry
        function formatCardExpiry(input) {
            let value = input.value.replace(/\D/g, '');
            value = value.replace(/(\d{2})(\d{2})/, '$1/$2');
            input.value = value;
        }

        // Format currency
        function formatCurrency(input) {
            let value = input.value.replace(/\D/g, '');
            value = (parseInt(value) / 100).toFixed(2);
            value = value.replace('.', ',');
            value = value.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
            input.value = 'R$ ' + value;
        }

        // Calculate change
        function calculateChange() {
            const cashAmountInput = document.getElementById('cash-amount');
            const changeAmountDiv = document.getElementById('change-amount');
            const total = cart.reduce((sum, item) => sum + (item.finalPrice * item.quantity), 0);
            
            const cashValue = parseFloat(cashAmountInput.value.replace(/[^\d,]/g, '').replace(',', '.'));
            
            if (cashValue > total) {
                const change = cashValue - total;
                changeAmountDiv.textContent = `Troco: R$ ${change.toFixed(2).replace('.', ',')}`;
                changeAmountDiv.className = 'mt-2 text-sm text-green-600 font-medium';
            } else if (cashValue < total) {
                const missing = total - cashValue;
                changeAmountDiv.textContent = `Faltam: R$ ${missing.toFixed(2).replace('.', ',')}`;
                changeAmountDiv.className = 'mt-2 text-sm text-red-600 font-medium';
            } else {
                changeAmountDiv.textContent = 'Valor exato';
                changeAmountDiv.className = 'mt-2 text-sm text-blue-600 font-medium';
            }
        }

        // Generate PIX QR Code
        function generatePixQRCode() {
            const qrCodeDiv = document.getElementById('pix-qr-code');
            const total = cart.reduce((sum, item) => sum + (item.finalPrice * item.quantity), 0);
            
            // Update PIX key with total amount
            const pixKey = document.getElementById('pix-key');
            pixKey.value = `00020126580014BR.GOV.BCB.PIX013663981293361520400005303986540${total.toFixed(2).replace('.', '')}5802BR5925RESTAURANTE SABOR LTDA6009PALMAS6304`;
            
            // Generate QR Code (mock)
            qrCodeDiv.innerHTML = `
                <div class="w-full h-full bg-white border-2 border-blue-300 rounded-lg flex items-center justify-center">
                    <div class="text-center">
                        <div class="grid grid-cols-8 gap-1 mb-2">
                            ${Array.from({length: 64}, (_, i) => 
                                `<div class="w-2 h-2 ${Math.random() > 0.5 ? 'bg-black' : 'bg-white'}"></div>`
                            ).join('')}
                        </div>
                        <p class="text-xs text-gray-600">QR Code PIX</p>
                    </div>
                </div>
            `;
        }

        // Copy PIX key
        function copyPixKey() {
            const pixKey = document.getElementById('pix-key');
            pixKey.select();
            document.execCommand('copy');
            showToast('Chave PIX copiada!');
        }

        // Open order confirmation
        function openOrderConfirmation(orderData) {
            const modal = document.getElementById('order-confirmation-modal');
            const estimatedTime = document.getElementById('estimated-time');
            
            // Set estimated time based on order mode
            const orderMode = orderData.orderMode;
            if (orderMode === 'delivery') {
                estimatedTime.textContent = 'Tempo estimado: 45-60 min';
                document.getElementById('status-2-text').textContent = 'Em rota';
                document.getElementById('status-3-text').textContent = 'Finalizado';
            } else if (orderMode === 'pickup') {
                estimatedTime.textContent = 'Tempo estimado: 20-30 min';
                document.getElementById('status-2-text').textContent = 'Pronto para retirada';
                document.getElementById('status-3-text').textContent = 'Finalizado';
            } else {
                estimatedTime.textContent = 'Tempo estimado: 15-25 min';
                document.getElementById('status-2-text').textContent = 'Pronto';
                document.getElementById('status-3-text').textContent = 'Finalizado';
            }
            
            modal.classList.remove('hidden');
            
            // Simulate order progress
            setTimeout(() => updateConfirmationStatus(2), 8000);
            setTimeout(() => updateConfirmationStatus(3), 20000);
        }

        // Update confirmation status
        function updateConfirmationStatus(statusNumber) {
            const statusElement = document.getElementById(`status-${statusNumber}`);
            const statusText = statusElement.nextElementSibling.querySelector('.text-sm');
            
            statusElement.classList.remove('bg-gray-300');
            statusElement.classList.add('bg-green-500');
            
            statusText.classList.remove('text-gray-500');
            statusText.classList.add('text-gray-900');
        }

        // Open order tracking
        function openOrderTracking() {
            // Close confirmation modal first
            document.getElementById('order-confirmation-modal').classList.add('hidden');
            
            const modal = document.getElementById('order-tracking-modal');
            const orderNumber = document.getElementById('order-number');
            const orderTotal = document.getElementById('order-total-tracking');
            const estimatedTimeTracking = document.getElementById('estimated-time-tracking');
            const statusTime1 = document.getElementById('status-time-1');
            
            // Generate order number
            const orderNum = Math.floor(Math.random() * 90000) + 10000;
            orderNumber.textContent = `#${orderNum}`;
            
            // Set total
            const total = cart.reduce((sum, item) => sum + (item.finalPrice * item.quantity), 0);
            orderTotal.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
            
            // Set estimated time
            estimatedTimeTracking.textContent = '30-45 min';
            
            // Set current time
            const now = new Date();
            statusTime1.textContent = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            
            modal.classList.remove('hidden');
            
            // Simulate order progress
            setTimeout(() => updateTrackingStatus(2), 5000);
            setTimeout(() => updateTrackingStatus(3), 15000);
        }

        // Update tracking status
        function updateTrackingStatus(statusNumber) {
            const statusElement = document.getElementById(`status-tracking-${statusNumber}`);
            const timeElement = document.getElementById(`status-time-${statusNumber}`);
            const statusText = statusElement.nextElementSibling.querySelector('.text-sm');
            
            statusElement.classList.remove('bg-gray-300');
            statusElement.classList.add('bg-green-500');
            
            statusText.classList.remove('text-gray-500');
            statusText.classList.add('text-gray-900');
            
            const now = new Date();
            timeElement.textContent = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            timeElement.classList.remove('text-gray-400');
            timeElement.classList.add('text-gray-500');
        }

        // Close order tracking
        function closeOrderTracking() {
            const modal = document.getElementById('order-tracking-modal');
            modal.classList.add('hidden');
        }

        // Share order
        function shareOrder() {
            const orderNumber = document.getElementById('order-number').textContent;
            const orderTotal = document.getElementById('order-total-tracking').textContent;
            
            const shareText = `üçΩÔ∏è Meu pedido no Restaurante Sabor\n\nPedido: ${orderNumber}\nTotal: ${orderTotal}\n\nAcompanhe em: https://restaurantesabor.com/pedido/${orderNumber.replace('#', '')}`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Meu Pedido - Restaurante Sabor',
                    text: shareText
                });
            } else {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(shareText).then(() => {
                    showToast('Link do pedido copiado!');
                });
            }
        }

        // PIX Payment Functions
        function openPixPayment(total) {
            const modal = document.getElementById('pix-payment-modal');
            const pixKey = document.getElementById('pix-key-payment');
            const qrCodeDiv = document.getElementById('pix-qr-code-payment');
            
            // Update PIX key with total amount
            pixKey.value = `00020126580014BR.GOV.BCB.PIX013663981293361520400005303986540${total.toFixed(2).replace('.', '')}5802BR5925RESTAURANTE SABOR LTDA6009PALMAS6304`;
            
            // Generate QR Code (mock)
            qrCodeDiv.innerHTML = `
                <div class="w-full h-full bg-white border-2 border-blue-300 rounded-lg flex items-center justify-center">
                    <div class="text-center">
                        <div class="grid grid-cols-8 gap-1 mb-2">
                            ${Array.from({length: 64}, (_, i) => 
                                `<div class="w-2 h-2 ${Math.random() > 0.5 ? 'bg-black' : 'bg-white'}"></div>`
                            ).join('')}
                        </div>
                        <p class="text-xs text-gray-600">QR Code PIX</p>
                        <p class="text-xs font-bold text-blue-600 mt-1">R$ ${total.toFixed(2).replace('.', ',')}</p>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function copyPixKeyPayment() {
            const pixKey = document.getElementById('pix-key-payment');
            pixKey.select();
            document.execCommand('copy');
            showToast('Chave PIX copiada!');
        }

        function finishPixPayment() {
            closePixPayment();
            showToast('Pagamento PIX confirmado!');
            
            // Show order confirmation
            setTimeout(() => {
                const orderData = { orderMode: 'delivery' }; // This should be passed from the checkout
                openOrderConfirmation(orderData);
            }, 1000);
        }

        function closePixPayment() {
            const modal = document.getElementById('pix-payment-modal');
            modal.classList.add('hidden');
        }

        // Card Payment Functions
        function openCardPayment(total) {
            const modal = document.getElementById('card-payment-modal');
            const cardTotal = document.getElementById('card-payment-total');
            
            cardTotal.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
            modal.classList.remove('hidden');
        }

        function processCardPayment() {
            const cardNumber = document.getElementById('card-number-payment').value;
            const cardExpiry = document.getElementById('card-expiry-payment').value;
            const cardCvv = document.getElementById('card-cvv-payment').value;
            const cardName = document.getElementById('card-name-payment').value;
            
            if (!cardNumber || !cardExpiry || !cardCvv || !cardName) {
                showToast('Preencha todos os dados do cart√£o!');
                return;
            }
            
            // Simulate payment processing
            showToast('Processando pagamento...');
            
            setTimeout(() => {
                closeCardPayment();
                showToast('Pagamento aprovado!');
                
                // Show order confirmation
                setTimeout(() => {
                    const orderData = { orderMode: 'delivery' }; // This should be passed from the checkout
                    openOrderConfirmation(orderData);
                }, 1000);
            }, 2000);
        }

        function closeCardPayment() {
            const modal = document.getElementById('card-payment-modal');
            modal.classList.add('hidden');
            
            // Reset form
            document.getElementById('card-payment-form').reset();
        }

        // Handle checkout form submission
        document.addEventListener('DOMContentLoaded', function() {
            const checkoutForm = document.getElementById('checkout-form');
            if (checkoutForm) {
                checkoutForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const customerName = document.getElementById('customer-name').value;
                    const customerPhone = document.getElementById('customer-phone').value;
                    const orderMode = document.querySelector('input[name="order-mode"]:checked')?.value;
                    const paymentMethod = document.querySelector('input[name="payment-method"]:checked')?.value;
                    
                    if (!customerName || !customerPhone || !orderMode || !paymentMethod) {
                        showToast('Preencha todos os campos obrigat√≥rios!');
                        return;
                    }
                    
                    // Validate delivery fields if delivery is selected
                    if (orderMode === 'delivery') {
                        const deliveryCep = document.getElementById('delivery-cep').value;
                        
                        if (!deliveryCep) {
                            showToast('Preencha o CEP de entrega!');
                            return;
                        }
                    }
                    
                    // Validate payment specific fields
                    if (paymentMethod === 'card-online') {
                        const cardNumber = document.getElementById('card-number').value;
                        const cardExpiry = document.getElementById('card-expiry').value;
                        const cardCvv = document.getElementById('card-cvv').value;
                        const cardName = document.getElementById('card-name').value;
                        
                        if (!cardNumber || !cardExpiry || !cardCvv || !cardName) {
                            showToast('Preencha todos os dados do cart√£o!');
                            return;
                        }
                    }
                    
                    if (paymentMethod === 'card-machine') {
                        const cardType = document.querySelector('input[name="card-type"]:checked')?.value;
                        if (!cardType) {
                            showToast('Selecione o tipo de cart√£o!');
                            return;
                        }
                    }
                    
                    // Process order
                    const orderData = {
                        customerName,
                        customerPhone,
                        orderMode,
                        paymentMethod,
                        cart: [...cart],
                        total: cart.reduce((sum, item) => sum + (item.finalPrice * item.quantity), 0)
                    };
                    
                    // Clear cart and close modal
                    const cartCopy = [...cart];
                    cart = [];
                    updateCartUI();
                    closeCheckoutModal();
                    toggleCart();
                    
                    // Handle payment method
                    if (paymentMethod === 'pix') {
                        setTimeout(() => {
                            openPixPayment(orderData.total);
                        }, 500);
                    } else if (paymentMethod === 'card-online') {
                        setTimeout(() => {
                            openCardPayment(orderData.total);
                        }, 500);
                    } else {
                        // For cash and card-machine, go directly to confirmation
                        setTimeout(() => {
                            openOrderConfirmation(orderData);
                        }, 500);
                    }
                });
            }
            
            renderMenuItems();
            updateCartUI();
        });

        function formatPhone(input) {
            let value = input.value.replace(/\D/g, '');
            
            if (value.length <= 11) {
                value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                if (value.length < 15) {
                    value = value.replace(/(\d{2})(\d{4})(\d{4})/, '($1) $2-$3');
                }
            }
            
            input.value = value;
        }

        function openRestaurantProfile() {
            const modal = document.getElementById('restaurant-profile-modal');
            modal.classList.remove('hidden');
        }

        function closeRestaurantProfile() {
            const modal = document.getElementById('restaurant-profile-modal');
            modal.classList.add('hidden');
        }

        // Image gallery data
        const restaurantImages = [
            {
                src: 'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=1200&h=800&fit=crop&crop=center',
                alt: 'Interior do restaurante',
                fallback: 'üçΩÔ∏è'
            },
            {
                src: 'https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=1200&h=800&fit=crop&crop=center',
                alt: 'Ambiente do restaurante',
                fallback: 'üè™'
            },
            {
                src: 'https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=1200&h=800&fit=crop&crop=center',
                alt: 'Mesa do restaurante',
                fallback: 'üç¥'
            },
            {
                src: 'https://images.unsplash.com/photo-1551218808-94e220e084d2?w=1200&h=800&fit=crop&crop=center',
                alt: 'Cozinha do restaurante',
                fallback: 'üë®‚Äçüç≥'
            },
            {
                src: 'https://images.unsplash.com/photo-1559329007-40df8a9345d8?w=1200&h=800&fit=crop&crop=center',
                alt: 'Fachada do restaurante',
                fallback: 'üè¢'
            }
        ];

        const logoImage = {
            src: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgdmlld0JveD0iMCAwIDQwMCA0MDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iNDAwIiByeD0iNDAiIGZpbGw9InVybCgjZ3JhZGllbnQwX2xpbmVhcl8xXzEpIi8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWRpZW50MF9saW5lYXJfMV8xIiB4MT0iMCIgeTE9IjAiIHgyPSI0MDAiIHkyPSI0MDAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iI0Y5NzMxNiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNEQzI2MjYiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8cGF0aCBkPSJNMjAwIDEwMEMxNzIuMzg2IDEwMCAxNTAgMTIyLjM4NiAxNTAgMTUwVjI1MEMxNTAgMjc3LjYxNCAxNzIuMzg2IDMwMCAyMDAgMzAwQzIyNy42MTQgMzAwIDI1MCAyNzcuNjE0IDI1MCAyNTBWMTUwQzI1MCAxMjIuMzg2IDIyNy42MTQgMTAwIDIwMCAxMDBaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTcwIDEzMEgxNDBDMTMxLjE2MyAxMzAgMTI0IDEzNy4xNjMgMTI0IDE0NkMxMjQgMTU0LjgzNyAxMzEuMTYzIDE2MiAxNDAgMTYySDI2MEMyNjguODM3IDE2MiAyNzYgMTU0LjgzNyAyNzYgMTQ2QzI3NiAxMzcuMTYzIDI2OC44MzcgMTMwIDI2MCAxMzBIMjMwIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjgiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8cGF0aCBkPSJNMTcwIDI3MEgxNDBDMTMxLjE2MyAyNzAgMTI0IDI3Ny4xNjMgMTI0IDI4NkMxMjQgMjk0LjgzNyAxMzEuMTYzIDMwMiAxNDAgMzAySDI2MEMyNjguODM3IDMwMiAyNzYgMjk0LjgzNyAyNzYgMjg2QzI3NiAyNzcuMTYzIDI2OC44MzcgMjcwIDI2MCAyNzBIMjMwIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjgiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K',
            alt: 'Logo do Restaurante Sabor',
            fallback: 'üçΩÔ∏è'
        };

        let currentImageIndex = 0;
        let currentImageType = 'gallery'; // 'gallery' or 'logo'
        let touchStartX = 0;
        let touchEndX = 0;

        function openImageModal(imageIndex) {
            const modal = document.getElementById('image-modal');
            const modalImage = document.getElementById('modal-image');
            const imageCounter = document.getElementById('image-counter');
            const prevBtn = document.getElementById('prev-image-btn');
            const nextBtn = document.getElementById('next-image-btn');
            const imageContainer = document.getElementById('image-container');
            
            if (imageIndex === 'logo') {
                currentImageType = 'logo';
                currentImageIndex = 0;
                modalImage.src = logoImage.src;
                modalImage.alt = logoImage.alt;
                imageCounter.textContent = 'Logo';
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
            } else {
                currentImageType = 'gallery';
                currentImageIndex = imageIndex;
                const image = restaurantImages[imageIndex];
                modalImage.src = image.src;
                modalImage.alt = image.alt;
                imageCounter.textContent = `${imageIndex + 1} / ${restaurantImages.length}`;
                prevBtn.style.display = 'flex';
                nextBtn.style.display = 'flex';
            }
            
            // Add touch event listeners
            imageContainer.addEventListener('touchstart', handleTouchStart, { passive: true });
            imageContainer.addEventListener('touchend', handleTouchEnd, { passive: true });
            
            // Add keyboard event listener
            document.addEventListener('keydown', handleKeyPress);
            
            modal.classList.remove('hidden');
        }

        function closeImageModal() {
            const modal = document.getElementById('image-modal');
            const imageContainer = document.getElementById('image-container');
            
            // Remove event listeners
            imageContainer.removeEventListener('touchstart', handleTouchStart);
            imageContainer.removeEventListener('touchend', handleTouchEnd);
            document.removeEventListener('keydown', handleKeyPress);
            
            modal.classList.add('hidden');
        }

        function previousImage() {
            if (currentImageType === 'logo') return;
            
            currentImageIndex = currentImageIndex > 0 ? currentImageIndex - 1 : restaurantImages.length - 1;
            updateModalImage();
        }

        function nextImage() {
            if (currentImageType === 'logo') return;
            
            currentImageIndex = currentImageIndex < restaurantImages.length - 1 ? currentImageIndex + 1 : 0;
            updateModalImage();
        }

        function updateModalImage() {
            const modalImage = document.getElementById('modal-image');
            const imageCounter = document.getElementById('image-counter');
            
            if (currentImageType === 'gallery') {
                const image = restaurantImages[currentImageIndex];
                modalImage.src = image.src;
                modalImage.alt = image.alt;
                imageCounter.textContent = `${currentImageIndex + 1} / ${restaurantImages.length}`;
            }
        }

        function handleTouchStart(e) {
            touchStartX = e.changedTouches[0].screenX;
        }

        function handleTouchEnd(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }

        function handleSwipe() {
            if (currentImageType === 'logo') return;
            
            const swipeThreshold = 50;
            const swipeDistance = touchEndX - touchStartX;
            
            if (Math.abs(swipeDistance) > swipeThreshold) {
                if (swipeDistance > 0) {
                    previousImage();
                } else {
                    nextImage();
                }
            }
        }

        function handleKeyPress(e) {
            if (e.key === 'Escape') {
                closeImageModal();
            } else if (e.key === 'ArrowLeft') {
                previousImage();
            } else if (e.key === 'ArrowRight') {
                nextImage();
            }
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            const toastIcon = toast.querySelector('i');
            
            toastMessage.textContent = message;
            
            // Detect negative messages for red toast
            const negativeWords = ['vazio', 'erro', 'falhou', 'n√£o foi poss√≠vel', 'inv√°lido', 'removido', 'cancelado', 'expirado', 'falha'];
            const isNegative = negativeWords.some(word => message.toLowerCase().includes(word));
            
            if (isNegative) {
                // Red toast for negative messages
                toast.className = 'fixed top-4 right-4 bg-gradient-to-r from-red-500 to-red-600 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-[calc(100%+2rem)] transition-transform duration-300 z-50';
                toastIcon.className = 'fas fa-times';
            } else {
                // Green toast for positive messages
                toast.className = 'fixed top-4 right-4 bg-gradient-to-r from-green-500 to-emerald-500 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-[calc(100%+2rem)] transition-transform duration-300 z-50';
                toastIcon.className = 'fas fa-check';
            }
            
            // Show toast
            toast.classList.remove('translate-x-[calc(100%+2rem)]');
            toast.classList.add('translate-x-0');
            
            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.remove('translate-x-0');
                toast.classList.add('translate-x-[calc(100%+2rem)]');
            }, 3000);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9747494e207a9892',t:'MTc1NjA4NTAzMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
